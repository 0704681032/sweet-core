"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});

var _tokenizer = require("shift-parser/dist/tokenizer");

var _tokenizer2 = _interopRequireDefault(_tokenizer);

var _immutable = require("immutable");

var _syntax = require("./syntax");

var _syntax2 = _interopRequireDefault(_syntax);

var _ramdaFantasy = require("ramda-fantasy");

var _errors = require("./errors");

var _terms = require("./terms");

var _terms2 = _interopRequireDefault(_terms);

var _ramda = require("ramda");

var R = _interopRequireWildcard(_ramda);

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

const Just_625 = _ramdaFantasy.Maybe.Just;
const Nothing_626 = _ramdaFantasy.Maybe.Nothing;
const LSYNTAX_627 = { name: "left-syntax" };
const RSYNTAX_628 = { name: "right-syntax" };
const AT_629 = { klass: _tokenizer.TokenClass.Punctuator, name: "@" };
const literalKeywords_630 = ["this", "null", "true", "false"];
const isLeftBracket_631 = R.whereEq({ type: _tokenizer.TokenType.LBRACK });
const isLeftBrace_632 = R.whereEq({ type: _tokenizer.TokenType.LBRACE });
const isLeftParen_633 = R.whereEq({ type: _tokenizer.TokenType.LPAREN });
const isRightBracket_634 = R.whereEq({ type: _tokenizer.TokenType.RBRACK });
const isRightBrace_635 = R.whereEq({ type: _tokenizer.TokenType.RBRACE });
const isRightParen_636 = R.whereEq({ type: _tokenizer.TokenType.RPAREN });
const isEOS_637 = R.whereEq({ type: _tokenizer.TokenType.EOS });
const isHash_638 = R.whereEq({ type: _tokenizer.TokenType.IDENTIFIER, value: "#" });
const isLeftSyntax_639 = R.whereEq({ type: LSYNTAX_627 });
const isRightSyntax_640 = R.whereEq({ type: RSYNTAX_628 });
const isLeftDelimiter_641 = R.anyPass([isLeftBracket_631, isLeftBrace_632, isLeftParen_633, isLeftSyntax_639]);
const isRightDelimiter_642 = R.anyPass([isRightBracket_634, isRightBrace_635, isRightParen_636, isRightSyntax_640]);
const isMatchingDelimiters_643 = R.cond([[isLeftBracket_631, (__684, b_685) => isRightBracket_634(b_685)], [isLeftBrace_632, (__686, b_687) => isRightBrace_635(b_687)], [isLeftParen_633, (__688, b_689) => isRightParen_636(b_689)], [isLeftSyntax_639, (__690, b_691) => isRightSyntax_640(b_691)], [R.T, R.F]]);
const assignOps_644 = ["=", "+=", "-=", "*=", "/=", "%=", "<<=", ">>=", ">>>=", "&=", "|=", "^=", ","];
const binaryOps_645 = ["+", "-", "*", "/", "%", "<<", ">>", ">>>", "&", "|", "^", "&&", "||", "?", ":", "===", "==", ">=", "<=", "<", ">", "!=", "!==", "instanceof"];
const unaryOps_646 = ["++", "--", "~", "!", "delete", "void", "typeof", "yield", "throw", "new"];
const isEmpty_647 = R.whereEq({ size: 0 });
const isPunctuator_648 = s_692 => s_692.match("punctuator");
const isKeyword_649 = s_693 => s_693.match("keyword");
const isDelimiter_650 = s_694 => s_694.match("delimiter");
const isParens_651 = s_695 => s_695.match("parens");
const isBraces_652 = s_696 => s_696.match("braces");
const isBrackets_653 = s_697 => s_697.match("brackets");
const isIdentifier_654 = s_698 => s_698.match("identifier");
const val_655 = s_699 => s_699.val();
const isVal_656 = R.curry((v_700, s_701) => s_701.val() === v_700);
const isDot_657 = R.allPass([isPunctuator_648, isVal_656(".")]);
const isColon_658 = R.allPass([isPunctuator_648, isVal_656(":")]);
const isFunctionKeyword_659 = R.allPass([isKeyword_649, isVal_656("function")]);
const isOperator_660 = s_702 => (s_702.match("punctuator") || s_702.match("keyword")) && R.any(R.equals(s_702.val()), assignOps_644.concat(binaryOps_645).concat(unaryOps_646));
const isNonLiteralKeyword_661 = R.allPass([isKeyword_649, s_703 => R.none(R.equals(s_703.val()), literalKeywords_630)]);
const isKeywordExprPrefix_662 = R.allPass([isKeyword_649, s_704 => R.any(R.equals(s_704.val()), ["instanceof", "typeof", "delete", "void", "yield", "throw", "new", "case"])]);
let last_663 = p_705 => p_705.last();
let safeLast_664 = R.pipe(R.cond([[isEmpty_647, R.always(Nothing_626())], [R.T, R.compose(_ramdaFantasy.Maybe.of, last_663)]]));
let stuffTrue_665 = R.curry((p_706, b_707) => b_707 ? Just_625(p_706) : Nothing_626());
let stuffFalse_666 = R.curry((p_708, b_709) => !b_709 ? Just_625(p_708) : Nothing_626());
let isTopColon_667 = R.pipe(safeLast_664, R.map(isColon_658), _ramdaFantasy.Maybe.maybe(false, R.identity));
let isTopPunctuator_668 = R.pipe(safeLast_664, R.map(isPunctuator_648), _ramdaFantasy.Maybe.maybe(false, R.identity));
let isExprReturn_669 = R.curry((l_710, p_711) => {
  let retKwd_712 = safeLast_664(p_711);
  let maybeDot_713 = pop_680(p_711).chain(safeLast_664);
  if (maybeDot_713.map(isDot_657).getOrElse(false)) {
    return true;
  }
  return retKwd_712.map(s_714 => {
    return s_714.match("keyword") && s_714.val() === "return" && s_714.lineNumber() === l_710;
  }).getOrElse(false);
});
const isTopOperator_670 = R.pipe(safeLast_664, R.map(isOperator_660), _ramdaFantasy.Maybe.maybe(false, R.identity));
const isTopKeywordExprPrefix_671 = R.pipe(safeLast_664, R.map(isKeywordExprPrefix_662), _ramdaFantasy.Maybe.maybe(false, R.identity));
let isExprPrefix_672 = R.curry((l_715, b_716) => R.cond([[isEmpty_647, R.always(b_716)], [isTopColon_667, R.always(b_716)], [isTopKeywordExprPrefix_671, R.T], [isTopOperator_670, R.T], [isTopPunctuator_668, R.always(b_716)], [isExprReturn_669(l_715), R.T], [R.T, R.F]]));
let curly_673 = p_717 => safeLast_664(p_717).map(isBraces_652).chain(stuffTrue_665(p_717));
let paren_674 = p_718 => safeLast_664(p_718).map(isParens_651).chain(stuffTrue_665(p_718));
let func_675 = p_719 => safeLast_664(p_719).map(isFunctionKeyword_659).chain(stuffTrue_665(p_719));
let ident_676 = p_720 => safeLast_664(p_720).map(isIdentifier_654).chain(stuffTrue_665(p_720));
let nonLiteralKeyword_677 = p_721 => safeLast_664(p_721).map(isNonLiteralKeyword_661).chain(stuffTrue_665(p_721));
let opt_678 = R.curry((a_722, b_723, p_724) => {
  let result_725 = R.pipeK(a_722, b_723)(_ramdaFantasy.Maybe.of(p_724));
  return _ramdaFantasy.Maybe.isJust(result_725) ? result_725 : _ramdaFantasy.Maybe.of(p_724);
});
let notDot_679 = R.ifElse(R.whereEq({ size: 0 }), Just_625, p_726 => safeLast_664(p_726).map(s_727 => !(s_727.match("punctuator") && s_727.val() === ".")).chain(stuffTrue_665(p_726)));
let pop_680 = R.compose(Just_625, p_728 => p_728.pop());
const functionPrefix_681 = R.pipeK(curly_673, pop_680, paren_674, pop_680, opt_678(ident_676, pop_680), func_675);
const isRegexPrefix_682 = b_729 => R.anyPass([isEmpty_647, isTopPunctuator_668, R.pipe(_ramdaFantasy.Maybe.of, R.pipeK(nonLiteralKeyword_677, pop_680, notDot_679), _ramdaFantasy.Maybe.isJust), R.pipe(_ramdaFantasy.Maybe.of, R.pipeK(paren_674, pop_680, nonLiteralKeyword_677, pop_680, notDot_679), _ramdaFantasy.Maybe.isJust), R.pipe(_ramdaFantasy.Maybe.of, functionPrefix_681, R.chain(p_730 => {
  return safeLast_664(p_730).map(s_731 => s_731.lineNumber()).chain(fnLine_732 => {
    return pop_680(p_730).map(isExprPrefix_672(fnLine_732, b_729));
  }).chain(stuffFalse_666(p_730));
}), _ramdaFantasy.Maybe.isJust), p_733 => {
  let isCurly_734 = _ramdaFantasy.Maybe.isJust(safeLast_664(p_733).map(isBraces_652));
  let alreadyCheckedFunction_735 = R.pipe(_ramdaFantasy.Maybe.of, functionPrefix_681, _ramdaFantasy.Maybe.isJust)(p_733);
  if (alreadyCheckedFunction_735) {
    return false;
  }
  return R.pipe(_ramdaFantasy.Maybe.of, R.chain(curly_673), R.chain(p_736 => {
    return safeLast_664(p_736).map(s_737 => s_737.lineNumber()).chain(curlyLine_738 => {
      return pop_680(p_736).map(isExprPrefix_672(curlyLine_738, b_729));
    }).chain(stuffFalse_666(p_736));
  }), _ramdaFantasy.Maybe.isJust)(p_733);
}]);
function lastEl_683(l_739) {
  return l_739[l_739.length - 1];
}
class Reader extends _tokenizer2.default {
  constructor(strings_740, context_741, replacements_742) {
    super(Array.isArray(strings_740) ? strings_740.join("") : strings_740);
    this.delimStack = new Map();
    this.insideSyntaxTemplate = [false];
    this.context = context_741;
    if (Array.isArray(strings_740)) {
      let totalIndex = 0;
      this.replacementIndex = R.reduce((acc_743, strRep_744) => {
        acc_743.push({ index: totalIndex + strRep_744[0].length, replacement: strRep_744[1] });
        totalIndex += strRep_744[0].length;
        return acc_743;
      }, [], R.zip(strings_740, replacements_742));
    }
  }
  read() {
    let stack_745 = arguments.length <= 0 || arguments[0] === undefined ? [] : arguments[0];
    let b_746 = arguments.length <= 1 || arguments[1] === undefined ? false : arguments[1];
    let singleDelimiter_747 = arguments.length <= 2 || arguments[2] === undefined ? false : arguments[2];

    let prefix_748 = (0, _immutable.List)();
    while (true) {
      let tok = this.advance(prefix_748, b_746);
      if (tok instanceof _syntax2.default || tok instanceof _terms2.default) {
        stack_745.push(tok);
        continue;
      }
      if (Array.isArray(tok)) {
        Array.prototype.push.apply(stack_745, tok);
        continue;
      }
      if (_immutable.List.isList(tok)) {
        Array.prototype.push.apply(stack_745, tok.toArray());
        continue;
      }
      if (isEOS_637(tok)) {
        if (stack_745[0] && isLeftDelimiter_641(stack_745[0].token)) {
          throw this.createUnexpected(tok);
        }
        break;
      }
      if (isLeftDelimiter_641(tok)) {
        if (isLeftSyntax_639(tok)) {
          this.insideSyntaxTemplate.push(true);
        }
        let line = tok.slice.startLocation.line;
        let innerB = isLeftBrace_632(tok) ? isExprPrefix_672(line, b_746)(prefix_748) : true;
        let inner = this.read([new _syntax2.default(tok, this.context)], innerB, false);
        let stx = new _syntax2.default(inner, this.context);
        prefix_748 = prefix_748.concat(stx);
        stack_745.push(stx);
        if (singleDelimiter_747) {
          break;
        }
      } else if (isRightDelimiter_642(tok)) {
        if (stack_745[0] && !isMatchingDelimiters_643(stack_745[0].token, tok)) {
          throw this.createUnexpected(tok);
        }
        let stx = new _syntax2.default(tok, this.context);
        stack_745.push(stx);
        if (lastEl_683(this.insideSyntaxTemplate) && isRightSyntax_640(tok)) {
          this.insideSyntaxTemplate.pop();
        }
        break;
      } else {
        let stx = new _syntax2.default(tok, this.context);
        prefix_748 = prefix_748.concat(stx);
        stack_745.push(stx);
      }
    }
    return (0, _immutable.List)(stack_745);
  }
  advance(prefix_749, b_750) {
    let startLocation_751 = this.getLocation();
    this.lastIndex = this.index;
    this.lastLine = this.line;
    this.lastLineStart = this.lineStart;
    this.skipComment();
    this.startIndex = this.index;
    this.startLine = this.line;
    this.startLineStart = this.lineStart;
    if (this.replacementIndex && this.replacementIndex[0] && this.index >= this.replacementIndex[0].index) {
      let rep = this.replacementIndex[0].replacement;
      this.replacementIndex.shift();
      return rep;
    }
    let charCode_752 = this.source.charCodeAt(this.index);
    if (charCode_752 === 96) {
      let element,
          items = [];
      let startLocation_751 = this.getLocation();
      let start = this.index;
      this.index++;
      if (lastEl_683(this.insideSyntaxTemplate)) {
        let slice = this.getSlice(start, startLocation_751);
        return { type: RSYNTAX_628, value: "`", slice: slice };
      }
      do {
        element = this.scanTemplateElement();
        items.push(element);
        if (element.interp) {
          element = this.read([], false, true);
          (0, _errors.assert)(element.size === 1, "should only have read a single delimiter inside a template");
          items.push(element.get(0));
        }
      } while (!element.tail);
      return { type: _tokenizer.TokenType.TEMPLATE, items: (0, _immutable.List)(items) };
    } else if (charCode_752 === 35) {
      let startLocation_751 = this.getLocation();
      let start = this.index;
      let slice = this.getSlice(start, startLocation_751);
      this.index++;
      if (this.source.charCodeAt(this.index) === 96) {
        this.index++;
        return { type: LSYNTAX_627, value: "#`", slice: slice };
      }
      return { type: _tokenizer.TokenType.IDENTIFIER, value: "#", slice: slice };
    } else if (charCode_752 === 64) {
      let startLocation_751 = this.getLocation();
      let start = this.index;
      let slice = this.getSlice(start, startLocation_751);
      this.index++;
      return { type: AT_629, value: "@", slice: slice };
    }
    let lookahead_753 = super.advance();
    if (lookahead_753.type === _tokenizer.TokenType.DIV && isRegexPrefix_682(b_750)(prefix_749)) {
      return super.scanRegExp("/");
    }
    return lookahead_753;
  }
  scanTemplateElement() {
    let startLocation_754 = this.getLocation();
    let start_755 = this.index;
    while (this.index < this.source.length) {
      let ch = this.source.charCodeAt(this.index);
      switch (ch) {
        case 96:
          let slice = this.getSlice(start_755, startLocation_754);
          this.index++;
          return { type: _tokenizer.TokenType.TEMPLATE, tail: true, interp: false, slice: slice };
        case 36:
          if (this.source.charCodeAt(this.index + 1) === 123) {
            let slice = this.getSlice(start_755, startLocation_754);
            this.index += 1;
            return { type: _tokenizer.TokenType.TEMPLATE, tail: false, interp: true, slice: slice };
          }
          this.index++;
          break;
        case 92:
          {
            let octal = this.scanStringEscape("", null)[1];
            if (octal != null) {
              throw this.createILLEGAL();
            }
            break;
          }
        default:
          this.index++;
      }
    }
    throw this.createILLEGAL();
  }
}
exports.default = Reader;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3N3ZWV0L3NoaWZ0LXJlYWRlci5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQTs7OztBQUVBOztBQUNBOzs7O0FBQ0E7O0FBQ0E7O0FBQ0E7Ozs7QUFDQTs7SUFBYSxDOzs7Ozs7QUFDYixNQUFNLFdBQVcsb0JBQU0sSUFBdkI7QUFDQSxNQUFNLGNBQWMsb0JBQU0sT0FBMUI7QUFDQSxNQUFNLGNBQWMsRUFBQyxNQUFNLGFBQVAsRUFBcEI7QUFDQSxNQUFNLGNBQWMsRUFBQyxNQUFNLGNBQVAsRUFBcEI7QUFDQSxNQUFNLFNBQVMsRUFBQyxPQUFPLHNCQUFXLFVBQW5CLEVBQStCLE1BQU0sR0FBckMsRUFBZjtBQUNBLE1BQU0sc0JBQXNCLENBQUMsTUFBRCxFQUFTLE1BQVQsRUFBaUIsTUFBakIsRUFBeUIsT0FBekIsQ0FBNUI7QUFDQSxNQUFNLG9CQUFvQixFQUFFLE9BQUYsQ0FBVSxFQUFDLE1BQU0scUJBQVUsTUFBakIsRUFBVixDQUExQjtBQUNBLE1BQU0sa0JBQWtCLEVBQUUsT0FBRixDQUFVLEVBQUMsTUFBTSxxQkFBVSxNQUFqQixFQUFWLENBQXhCO0FBQ0EsTUFBTSxrQkFBa0IsRUFBRSxPQUFGLENBQVUsRUFBQyxNQUFNLHFCQUFVLE1BQWpCLEVBQVYsQ0FBeEI7QUFDQSxNQUFNLHFCQUFxQixFQUFFLE9BQUYsQ0FBVSxFQUFDLE1BQU0scUJBQVUsTUFBakIsRUFBVixDQUEzQjtBQUNBLE1BQU0sbUJBQW1CLEVBQUUsT0FBRixDQUFVLEVBQUMsTUFBTSxxQkFBVSxNQUFqQixFQUFWLENBQXpCO0FBQ0EsTUFBTSxtQkFBbUIsRUFBRSxPQUFGLENBQVUsRUFBQyxNQUFNLHFCQUFVLE1BQWpCLEVBQVYsQ0FBekI7QUFDQSxNQUFNLFlBQVksRUFBRSxPQUFGLENBQVUsRUFBQyxNQUFNLHFCQUFVLEdBQWpCLEVBQVYsQ0FBbEI7QUFDQSxNQUFNLGFBQWEsRUFBRSxPQUFGLENBQVUsRUFBQyxNQUFNLHFCQUFVLFVBQWpCLEVB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O0FBQ0U7QUFDRSxnQkFBSSxRQUFRLEtBQUssZ0JBQUwsQ0FBc0IsRUFBdEIsRUFBMEIsSUFBMUIsRUFBZ0MsQ0FBaEMsQ0FBWjtBQUNBLGdCQUFJLFNBQVMsSUFBYixFQUFtQjtBQUNqQixvQkFBTSxLQUFLLGFBQUwsRUFBTjtBQUNEO0FBQ0Q7QUFDRDtBQUNIO0FBQ0UsZUFBSyxLQUFMO0FBdEJKO0FBd0JEO0FBQ0QsVUFBTSxLQUFLLGFBQUwsRUFBTjtBQUNEO0FBNUoyQztrQkFBekIsTSIsImZpbGUiOiJzaGlmdC1yZWFkZXIuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgVG9rZW5pemVyIGZyb20gXCJzaGlmdC1wYXJzZXIvZGlzdC90b2tlbml6ZXJcIjtcbmltcG9ydCB7VG9rZW5DbGFzcywgVG9rZW5UeXBlfSBmcm9tIFwic2hpZnQtcGFyc2VyL2Rpc3QvdG9rZW5pemVyXCI7XG5pbXBvcnQge0xpc3R9IGZyb20gXCJpbW11dGFibGVcIjtcbmltcG9ydCBTeW50YXggZnJvbSBcIi4vc3ludGF4XCI7XG5pbXBvcnQge01heWJlfSBmcm9tIFwicmFtZGEtZmFudGFzeVwiO1xuaW1wb3J0IHthc3NlcnR9IGZyb20gXCIuL2Vycm9yc1wiO1xuaW1wb3J0IFRlcm0gZnJvbSBcIi4vdGVybXNcIjtcbmltcG9ydCAgKiBhcyBSIGZyb20gXCJyYW1kYVwiO1xuY29uc3QgSnVzdF82MjUgPSBNYXliZS5KdXN0O1xuY29uc3QgTm90aGluZ182MjYgPSBNYXliZS5Ob3RoaW5nO1xuY29uc3QgTFNZTlRBWF82MjcgPSB7bmFtZTogXCJsZWZ0LXN5bnRheFwifTtcbmNvbnN0IFJTWU5UQVhfNjI4ID0ge25hbWU6IFwicmlnaHQtc3ludGF4XCJ9O1xuY29uc3QgQVRfNjI5ID0ge2tsYXNzOiBUb2tlbkNsYXNzLlB1bmN0dWF0b3IsIG5hbWU6IFwiQFwifTtcbmNvbnN0IGxpdGVyYWxLZXl3b3Jkc182MzAgPSBbXCJ0aGlzXCIsIFwibnVsbFwiLCBcInRydWVcIiwgXCJmYWxzZVwiXTtcbmNvbnN0IGlzTGVmdEJyYWNrZXRfNjMxID0gUi53aGVyZUVxKHt0eXBlOiBUb2tlblR5cGUuTEJSQUNLfSk7XG5jb25zdCBpc0xlZnRCcmFjZV82MzIgPSBSLndoZXJlRXEoe3R5cGU6IFRva2VuVHlwZS5MQlJBQ0V9KTtcbmNvbnN0IGlzTGVmdFBhcmVuXzYzMyA9IFIud2hlcmVFcSh7dHlwZTogVG9rZW5UeXBlLkxQQVJFTn0pO1xuY29uc3QgaXNSaWdodEJyYWNrZXRfNjM0ID0gUi53aGVyZUVxKHt0eXBlOiBUb2tlblR5cGUuUkJSQUNLfSk7XG5jb25zdCBpc1JpZ2h0QnJhY2VfNjM1ID0gUi53aGVyZUVxKHt0eXBlOiBUb2tlblR5cGUuUkJSQUNFfSk7XG5jb25zdCBpc1JpZ2h0UGFyZW5fNjM2ID0gUi53aGVyZUVxKHt0eXBlOiBUb2tlblR5cGUuUlBBUkVOfSk7XG5jb25zdCBpc0VPU182MzcgPSBSLndoZXJlRXEoe3R5cGU6IFRva2VuVHlwZS5FT1N9KTtcbmNvbnN0IGlzSGFzaF82MzggPSBSLndoZXJlRXEoe3R5cGU6IFRva2VuVHlwZS5JREVOVElGSUVSLCB2YWx1ZTogXCIjXCJ9KTtcbmNvbnN0IGlzTGVmdFN5bnRheF82MzkgPSBSLndoZXJlRXEoe3R5cGU6IExTWU5UQVhfNjI3fSk7XG5jb25zdCBpc1JpZ2h0U3ludGF4XzY0MCA9IFIud2hlcmVFcSh7dHlwZTogUlNZTlRBWF82Mjh9KTtcbmNvbnN0IGlzTGVmdERlbGltaXRlcl82NDEgPSBSLmFueVBhc3MoW2lzTGVmdEJyYWNrZXRfNjMxLCBpc0xlZnRCcmFjZV82MzIsIGlzTGVmdFBhcmVuXzYzMywgaXNMZWZ0U3ludGF4XzYzOV0pO1xuY29uc3QgaXNSaWdodERlbGltaXRlcl82NDIgPSBSLmFueVBhc3MoW2lzUmlnaHRCcmFja2V0XzYzNCwgaXNSaWdodEJyYWNlXzYzNSwgaXNSaWdodFBhcmVuXzYzNiwgaXNSaWdodFN5bnRheF82NDBdKTtcbmNvbnN0IGlzTWF0Y2hpbmdEZWxpbWl0ZXJzXzY0MyA9IFIuY29uZChbW2lzTGVmdEJyYWNrZXRfNjMxLCAoX182ODQsIGJfNjg1KSA9PiBpc1JpZ2h0QnJhY2tldF82MzQoYl82ODUpXSwgW2lzTGVmdEJyYWNlXzYzMiwgKF9fNjg2LCBiXzY4NykgPT4gaXNSaWdodEJyYWNlXzYzNShiXzY4NyldLCBbaXNMZWZ0UGFyZW5fNjMzLCAoX182ODgsIGJfNjg5KSA9PiBpc1JpZ2h0UGFyZW5fNjM2KGJfNjg5KV0sIFtpc0xlZnRTeW50YXhfNjM5LCAoX182OTAsIGJfNjkxKSA9PiBpc1JpZ2h0U3ludGF4XzY0MChiXzY5MSldLCBbUi5ULCBSLkZdXSk7XG5jb25zdCBhc3NpZ25PcHNfNjQ0ID0gW1wiPVwiLCBcIis9XCIsIFwiLT1cIiwgXCIqPVwiLCBcIi89XCIsIFwiJT1cIiwgXCI8PD1cIiwgXCI+Pj1cIiwgXCI+Pj49XCIsIFwiJj1cIiwgXCJ8PVwiLCBcIl49XCIsIFwiLFwiXTtcbmNvbnN0IGJpbmFyeU9wc182NDUgPSBbXCIrXCIsIFwiLVwiLCBcIipcIiwgXCIvXCIsIFwiJVwiLCBcIjw8XCIsIFwiPj5cIiwgXCI+Pj5cIiwgXCImXCIsIFwifFwiLCBcIl5cIiwgXCImJlwiLCBcInx8XCIsIFwiP1wiLCBcIjpcIiwgXCI9PT1cIiwgXCI9PVwiLCBcIj49XCIsIFwiPD1cIiwgXCI8XCIsIFwiPlwiLCBcIiE9XCIsIFwiIT09XCIsIFwiaW5zdGFuY2VvZlwiXTtcbmNvbnN0IHVuYXJ5T3BzXzY0NiA9IFtcIisrXCIsIFwiLS1cIiwgXCJ+XCIsIFwiIVwiLCBcImRlbGV0ZVwiLCBcInZvaWRcIiwgXCJ0eXBlb2ZcIiwgXCJ5aWVsZFwiLCBcInRocm93XCIsIFwibmV3XCJdO1xuY29uc3QgaXNFbXB0eV82NDcgPSBSLndoZXJlRXEoe3NpemU6IDB9KTtcbmNvbnN0IGlzUHVuY3R1YXRvcl82NDggPSBzXzY5MiA9PiBzXzY5Mi5tYXRjaChcInB1bmN0dWF0b3JcIik7XG5jb25zdCBpc0tleXdvcmRfNjQ5ID0gc182OTMgPT4gc182OTMubWF0Y2goXCJrZXl3b3JkXCIpO1xuY29uc3QgaXNEZWxpbWl0ZXJfNjUwID0gc182OTQgPT4gc182OTQubWF0Y2goXCJkZWxpbWl0ZXJcIik7XG5jb25zdCBpc1BhcmVuc182NTEgPSBzXzY5NSA9PiBzXzY5NS5tYXRjaChcInBhcmVuc1wiKTtcbmNvbnN0IGlzQnJhY2VzXzY1MiA9IHNfNjk2ID0+IHNfNjk2Lm1hdGNoKFwiYnJhY2VzXCIpO1xuY29uc3QgaXNCcmFja2V0c182NTMgPSBzXzY5NyA9PiBzXzY5Ny5tYXRjaChcImJyYWNrZXRzXCIpO1xuY29uc3QgaXNJZGVudGlmaWVyXzY1NCA9IHNfNjk4ID0+IHNfNjk4Lm1hdGNoKFwiaWRlbnRpZmllclwiKTtcbmNvbnN0IHZhbF82NTUgPSBzXzY5OSA9PiBzXzY5OS52YWwoKTtcbmNvbnN0IGlzVmFsXzY1NiA9IFIuY3VycnkoKHZfNzAwLCBzXzcwMSkgPT4gc183MDEudmFsKCkgPT09IHZfNzAwKTtcbmNvbnN0IGlzRG90XzY1NyA9IFIuYWxsUGFzcyhbaXNQdW5jdHVhdG9yXzY0OCwgaXNWYWxfNjU2KFwiLlwiKV0pO1xuY29uc3QgaXNDb2xvbl82NTggPSBSLmFsbFBhc3MoW2lzUHVuY3R1YXRvcl82NDgsIGlzVmFsXzY1NihcIjpcIildKTtcbmNvbnN0IGlzRnVuY3Rpb25LZXl3b3JkXzY1OSA9IFIuYWxsUGFzcyhbaXNLZXl3b3JkXzY0OSwgaXNWYWxfNjU2KFwiZnVuY3Rpb25cIildKTtcbmNvbnN0IGlzT3BlcmF0b3JfNjYwID0gc183MDIgPT4gKHNfNzAyLm1hdGNoKFwicHVuY3R1YXRvclwiKSB8fCBzXzcwMi5tYXRjaChcImtleXdvcmRcIikpICYmIFIuYW55KFIuZXF1YWxzKHNfNzAyLnZhbCgpKSwgYXNzaWduT3BzXzY0NC5jb25jYXQoYmluYXJ5T3BzXzY0NSkuY29uY2F0KHVuYXJ5T3BzXzY0NikpO1xuY29uc3QgaXNOb25MaXRlcmFsS2V5d29yZF82NjEgPSBSLmFsbFBhc3MoW2lzS2V5d29yZF82NDksIHNfNzAzID0+IFIubm9uZShSLmVxdWFscyhzXzcwMy52YWwoKSksIGxpdGVyYWxLZXl3b3Jkc182MzApXSk7XG5jb25zdCBpc0tleXdvcmRFeHByUHJlZml4XzY2MiA9IFIuYWxsUGFzcyhbaXNLZXl3b3JkXzY0OSwgc183MDQgPT4gUi5hbnkoUi5lcXVhbHMoc183MDQudmFsKCkpLCBbXCJpbnN0YW5jZW9mXCIsIFwidHlwZW9mXCIsIFwiZGVsZXRlXCIsIFwidm9pZFwiLCBcInlpZWxkXCIsIFwidGhyb3dcIiwgXCJuZXdcIiwgXCJjYXNlXCJdKV0pO1xubGV0IGxhc3RfNjYzID0gcF83MDUgPT4gcF83MDUubGFzdCgpO1xubGV0IHNhZmVMYXN0XzY2NCA9IFIucGlwZShSLmNvbmQoW1tpc0VtcHR5XzY0NywgUi5hbHdheXMoTm90aGluZ182MjYoKSldLCBbUi5ULCBSLmNvbXBvc2UoTWF5YmUub2YsIGxhc3RfNjYzKV1dKSk7XG5sZXQgc3R1ZmZUcnVlXzY2NSA9IFIuY3VycnkoKHBfNzA2LCBiXzcwNykgPT4gYl83MDcgPyBKdXN0XzYyNShwXzcwNikgOiBOb3RoaW5nXzYyNigpKTtcbmxldCBzdHVmZkZhbHNlXzY2NiA9IFIuY3VycnkoKHBfNzA4LCBiXzcwOSkgPT4gIWJfNzA5ID8gSnVzdF82MjUocF83MDgpIDogTm90aGluZ182MjYoKSk7XG5sZXQgaXNUb3BDb2xvbl82NjcgPSBSLnBpcGUoc2FmZUxhc3RfNjY0LCBSLm1hcChpc0NvbG9uXzY1OCksIE1heWJlLm1heWJlKGZhbHNlLCBSLmlkZW50aXR5KSk7XG5sZXQgaXNUb3BQdW5jdHVhdG9yXzY2OCA9IFIucGlwZShzYWZlTGFzdF82NjQsIFIubWFwKGlzUHVuY3R1YXRvcl82NDgpLCBNYXliZS5tYXliZShmYWxzZSwgUi5pZGVudGl0eSkpO1xubGV0IGlzRXhwclJldHVybl82NjkgPSBSLmN1cnJ5KChsXzcxMCwgcF83MTEpID0+IHtcbiAgbGV0IHJldEt3ZF83MTIgPSBzYWZlTGFzdF82NjQocF83MTEpO1xuICBsZXQgbWF5YmVEb3RfNzEzID0gcG9wXzY4MChwXzcxMSkuY2hhaW4oc2FmZUxhc3RfNjY0KTtcbiAgaWYgKG1heWJlRG90XzcxMy5tYXAoaXNEb3RfNjU3KS5nZXRPckVsc2UoZmFsc2UpKSB7XG4gICAgcmV0dXJuIHRydWU7XG4gIH1cbiAgcmV0dXJuIHJldEt3ZF83MTIubWFwKHNfNzE0ID0+IHtcbiAgICByZXR1cm4gc183MTQubWF0Y2goXCJrZXl3b3JkXCIpICYmIHNfNzE0LnZhbCgpID09PSBcInJldHVyblwiICYmIHNfNzE0LmxpbmVOdW1iZXIoKSA9PT0gbF83MTA7XG4gIH0pLmdldE9yRWxzZShmYWxzZSk7XG59KTtcbmNvbnN0IGlzVG9wT3BlcmF0b3JfNjcwID0gUi5waXBlKHNhZmVMYXN0XzY2NCwgUi5tYXAoaXNPcGVyYXRvcl82NjApLCBNYXliZS5tYXliZShmYWxzZSwgUi5pZGVudGl0eSkpO1xuY29uc3QgaXNUb3BLZXl3b3JkRXhwclByZWZpeF82NzEgPSBSLnBpcGUoc2FmZUxhc3RfNjY0LCBSLm1hcChpc0tleXdvcmRFeHByUHJlZml4XzY2MiksIE1heWJlLm1heWJlKGZhbHNlLCBSLmlkZW50aXR5KSk7XG5sZXQgaXNFeHByUHJlZml4XzY3MiA9IFIuY3VycnkoKGxfNzE1LCBiXzcxNikgPT4gUi5jb25kKFtbaXNFbXB0eV82NDcsIFIuYWx3YXlzKGJfNzE2KV0sIFtpc1RvcENvbG9uXzY2NywgUi5hbHdheXMoYl83MTYpXSwgW2lzVG9wS2V5d29yZEV4cHJQcmVmaXhfNjcxLCBSLlRdLCBbaXNUb3BPcGVyYXRvcl82NzAsIFIuVF0sIFtpc1RvcFB1bmN0dWF0b3JfNjY4LCBSLmFsd2F5cyhiXzcxNildLCBbaXNFeHByUmV0dXJuXzY2OShsXzcxNSksIFIuVF0sIFtSLlQsIFIuRl1dKSk7XG5sZXQgY3VybHlfNjczID0gcF83MTcgPT4gc2FmZUxhc3RfNjY0KHBfNzE3KS5tYXAoaXNCcmFjZXNfNjUyKS5jaGFpbihzdHVmZlRydWVfNjY1KHBfNzE3KSk7XG5sZXQgcGFyZW5fNjc0ID0gcF83MTggPT4gc2FmZUxhc3RfNjY0KHBfNzE4KS5tYXAoaXNQYXJlbnNfNjUxKS5jaGFpbihzdHVmZlRydWVfNjY1KHBfNzE4KSk7XG5sZXQgZnVuY182NzUgPSBwXzcxOSA9PiBzYWZlTGFzdF82NjQocF83MTkpLm1hcChpc0Z1bmN0aW9uS2V5d29yZF82NTkpLmNoYWluKHN0dWZmVHJ1ZV82NjUocF83MTkpKTtcbmxldCBpZGVudF82NzYgPSBwXzcyMCA9PiBzYWZlTGFzdF82NjQocF83MjApLm1hcChpc0lkZW50aWZpZXJfNjU0KS5jaGFpbihzdHVmZlRydWVfNjY1KHBfNzIwKSk7XG5sZXQgbm9uTGl0ZXJhbEtleXdvcmRfNjc3ID0gcF83MjEgPT4gc2FmZUxhc3RfNjY0KHBfNzIxKS5tYXAoaXNOb25MaXRlcmFsS2V5d29yZF82NjEpLmNoYWluKHN0dWZmVHJ1ZV82NjUocF83MjEpKTtcbmxldCBvcHRfNjc4ID0gUi5jdXJyeSgoYV83MjIsIGJfNzIzLCBwXzcyNCkgPT4ge1xuICBsZXQgcmVzdWx0XzcyNSA9IFIucGlwZUsoYV83MjIsIGJfNzIzKShNYXliZS5vZihwXzcyNCkpO1xuICByZXR1cm4gTWF5YmUuaXNKdXN0KHJlc3VsdF83MjUpID8gcmVzdWx0XzcyNSA6IE1heWJlLm9mKHBfNzI0KTtcbn0pO1xubGV0IG5vdERvdF82NzkgPSBSLmlmRWxzZShSLndoZXJlRXEoe3NpemU6IDB9KSwgSnVzdF82MjUsIHBfNzI2ID0+IHNhZmVMYXN0XzY2NChwXzcyNikubWFwKHNfNzI3ID0+ICEoc183MjcubWF0Y2goXCJwdW5jdHVhdG9yXCIpICYmIHNfNzI3LnZhbCgpID09PSBcIi5cIikpLmNoYWluKHN0dWZmVHJ1ZV82NjUocF83MjYpKSk7XG5sZXQgcG9wXzY4MCA9IFIuY29tcG9zZShKdXN0XzYyNSwgcF83MjggPT4gcF83MjgucG9wKCkpO1xuY29uc3QgZnVuY3Rpb25QcmVmaXhfNjgxID0gUi5waXBlSyhjdXJseV82NzMsIHBvcF82ODAsIHBhcmVuXzY3NCwgcG9wXzY4MCwgb3B0XzY3OChpZGVudF82NzYsIHBvcF82ODApLCBmdW5jXzY3NSk7XG5jb25zdCBpc1JlZ2V4UHJlZml4XzY4MiA9IGJfNzI5ID0+IFIuYW55UGFzcyhbaXNFbXB0eV82NDcsIGlzVG9wUHVuY3R1YXRvcl82NjgsIFIucGlwZShNYXliZS5vZiwgUi5waXBlSyhub25MaXRlcmFsS2V5d29yZF82NzcsIHBvcF82ODAsIG5vdERvdF82NzkpLCBNYXliZS5pc0p1c3QpLCBSLnBpcGUoTWF5YmUub2YsIFIucGlwZUsocGFyZW5fNjc0LCBwb3BfNjgwLCBub25MaXRlcmFsS2V5d29yZF82NzcsIHBvcF82ODAsIG5vdERvdF82NzkpLCBNYXliZS5pc0p1c3QpLCBSLnBpcGUoTWF5YmUub2YsIGZ1bmN0aW9uUHJlZml4XzY4MSwgUi5jaGFpbihwXzczMCA9PiB7XG4gIHJldHVybiBzYWZlTGFzdF82NjQocF83MzApLm1hcChzXzczMSA9PiBzXzczMS5saW5lTnVtYmVyKCkpLmNoYWluKGZuTGluZV83MzIgPT4ge1xuICAgIHJldHVybiBwb3BfNjgwKHBfNzMwKS5tYXAoaXNFeHByUHJlZml4XzY3MihmbkxpbmVfNzMyLCBiXzcyOSkpO1xuICB9KS5jaGFpbihzdHVmZkZhbHNlXzY2NihwXzczMCkpO1xufSksIE1heWJlLmlzSnVzdCksIHBfNzMzID0+IHtcbiAgbGV0IGlzQ3VybHlfNzM0ID0gTWF5YmUuaXNKdXN0KHNhZmVMYXN0XzY2NChwXzczMykubWFwKGlzQnJhY2VzXzY1MikpO1xuICBsZXQgYWxyZWFkeUNoZWNrZWRGdW5jdGlvbl83MzUgPSBSLnBpcGUoTWF5YmUub2YsIGZ1bmN0aW9uUHJlZml4XzY4MSwgTWF5YmUuaXNKdXN0KShwXzczMyk7XG4gIGlmIChhbHJlYWR5Q2hlY2tlZEZ1bmN0aW9uXzczNSkge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuICByZXR1cm4gUi5waXBlKE1heWJlLm9mLCBSLmNoYWluKGN1cmx5XzY3MyksIFIuY2hhaW4ocF83MzYgPT4ge1xuICAgIHJldHVybiBzYWZlTGFzdF82NjQocF83MzYpLm1hcChzXzczNyA9PiBzXzczNy5saW5lTnVtYmVyKCkpLmNoYWluKGN1cmx5TGluZV83MzggPT4ge1xuICAgICAgcmV0dXJuIHBvcF82ODAocF83MzYpLm1hcChpc0V4cHJQcmVmaXhfNjcyKGN1cmx5TGluZV83MzgsIGJfNzI5KSk7XG4gICAgfSkuY2hhaW4oc3R1ZmZGYWxzZV82NjYocF83MzYpKTtcbiAgfSksIE1heWJlLmlzSnVzdCkocF83MzMpO1xufV0pO1xuZnVuY3Rpb24gbGFzdEVsXzY4MyhsXzczOSkge1xuICByZXR1cm4gbF83MzlbbF83MzkubGVuZ3RoIC0gMV07XG59XG5leHBvcnQgZGVmYXVsdCBjbGFzcyBSZWFkZXIgZXh0ZW5kcyBUb2tlbml6ZXIge1xuICBjb25zdHJ1Y3RvcihzdHJpbmdzXzc0MCwgY29udGV4dF83NDEsIHJlcGxhY2VtZW50c183NDIpIHtcbiAgICBzdXBlcihBcnJheS5pc0FycmF5KHN0cmluZ3NfNzQwKSA/IHN0cmluZ3NfNzQwLmpvaW4oXCJcIikgOiBzdHJpbmdzXzc0MCk7XG4gICAgdGhpcy5kZWxpbVN0YWNrID0gbmV3IE1hcDtcbiAgICB0aGlzLmluc2lkZVN5bnRheFRlbXBsYXRlID0gW2ZhbHNlXTtcbiAgICB0aGlzLmNvbnRleHQgPSBjb250ZXh0Xzc0MTtcbiAgICBpZiAoQXJyYXkuaXNBcnJheShzdHJpbmdzXzc0MCkpIHtcbiAgICAgIGxldCB0b3RhbEluZGV4ID0gMDtcbiAgICAgIHRoaXMucmVwbGFjZW1lbnRJbmRleCA9IFIucmVkdWNlKChhY2NfNzQzLCBzdHJSZXBfNzQ0KSA9PiB7XG4gICAgICAgIGFjY183NDMucHVzaCh7aW5kZXg6IHRvdGFsSW5kZXggKyBzdHJSZXBfNzQ0WzBdLmxlbmd0aCwgcmVwbGFjZW1lbnQ6IHN0clJlcF83NDRbMV19KTtcbiAgICAgICAgdG90YWxJbmRleCArPSBzdHJSZXBfNzQ0WzBdLmxlbmd0aDtcbiAgICAgICAgcmV0dXJuIGFjY183NDM7XG4gICAgICB9LCBbXSwgUi56aXAoc3RyaW5nc183NDAsIHJlcGxhY2VtZW50c183NDIpKTtcbiAgICB9XG4gIH1cbiAgcmVhZChzdGFja183NDUgPSBbXSwgYl83NDYgPSBmYWxzZSwgc2luZ2xlRGVsaW1pdGVyXzc0NyA9IGZhbHNlKSB7XG4gICAgbGV0IHByZWZpeF83NDggPSBMaXN0KCk7XG4gICAgd2hpbGUgKHRydWUpIHtcbiAgICAgIGxldCB0b2sgPSB0aGlzLmFkdmFuY2UocHJlZml4Xzc0OCwgYl83NDYpO1xuICAgICAgaWYgKHRvayBpbnN0YW5jZW9mIFN5bnRheCB8fCB0b2sgaW5zdGFuY2VvZiBUZXJtKSB7XG4gICAgICAgIHN0YWNrXzc0NS5wdXNoKHRvayk7XG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgfVxuICAgICAgaWYgKEFycmF5LmlzQXJyYXkodG9rKSkge1xuICAgICAgICBBcnJheS5wcm90b3R5cGUucHVzaC5hcHBseShzdGFja183NDUsIHRvayk7XG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgfVxuICAgICAgaWYgKExpc3QuaXNMaXN0KHRvaykpIHtcbiAgICAgICAgQXJyYXkucHJvdG90eXBlLnB1c2guYXBwbHkoc3RhY2tfNzQ1LCB0b2sudG9BcnJheSgpKTtcbiAgICAgICAgY29udGludWU7XG4gICAgICB9XG4gICAgICBpZiAoaXNFT1NfNjM3KHRvaykpIHtcbiAgICAgICAgaWYgKHN0YWNrXzc0NVswXSAmJiBpc0xlZnREZWxpbWl0ZXJfNjQxKHN0YWNrXzc0NVswXS50b2tlbikpIHtcbiAgICAgICAgICB0aHJvdyB0aGlzLmNyZWF0ZVVuZXhwZWN0ZWQodG9rKTtcbiAgICAgICAgfVxuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIGlmIChpc0xlZnREZWxpbWl0ZXJfNjQxKHRvaykpIHtcbiAgICAgICAgaWYgKGlzTGVmdFN5bnRheF82MzkodG9rKSkge1xuICAgICAgICAgIHRoaXMuaW5zaWRlU3ludGF4VGVtcGxhdGUucHVzaCh0cnVlKTtcbiAgICAgICAgfVxuICAgICAgICBsZXQgbGluZSA9IHRvay5zbGljZS5zdGFydExvY2F0aW9uLmxpbmU7XG4gICAgICAgIGxldCBpbm5lckIgPSBpc0xlZnRCcmFjZV82MzIodG9rKSA/IGlzRXhwclByZWZpeF82NzIobGluZSwgYl83NDYpKHByZWZpeF83NDgpIDogdHJ1ZTtcbiAgICAgICAgbGV0IGlubmVyID0gdGhpcy5yZWFkKFtuZXcgU3ludGF4KHRvaywgdGhpcy5jb250ZXh0KV0sIGlubmVyQiwgZmFsc2UpO1xuICAgICAgICBsZXQgc3R4ID0gbmV3IFN5bnRheChpbm5lciwgdGhpcy5jb250ZXh0KTtcbiAgICAgICAgcHJlZml4Xzc0OCA9IHByZWZpeF83NDguY29uY2F0KHN0eCk7XG4gICAgICAgIHN0YWNrXzc0NS5wdXNoKHN0eCk7XG4gICAgICAgIGlmIChzaW5nbGVEZWxpbWl0ZXJfNzQ3KSB7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSBpZiAoaXNSaWdodERlbGltaXRlcl82NDIodG9rKSkge1xuICAgICAgICBpZiAoc3RhY2tfNzQ1WzBdICYmICFpc01hdGNoaW5nRGVsaW1pdGVyc182NDMoc3RhY2tfNzQ1WzBdLnRva2VuLCB0b2spKSB7XG4gICAgICAgICAgdGhyb3cgdGhpcy5jcmVhdGVVbmV4cGVjdGVkKHRvayk7XG4gICAgICAgIH1cbiAgICAgICAgbGV0IHN0eCA9IG5ldyBTeW50YXgodG9rLCB0aGlzLmNvbnRleHQpO1xuICAgICAgICBzdGFja183NDUucHVzaChzdHgpO1xuICAgICAgICBpZiAobGFzdEVsXzY4Myh0aGlzLmluc2lkZVN5bnRheFRlbXBsYXRlKSAmJiBpc1JpZ2h0U3ludGF4XzY0MCh0b2spKSB7XG4gICAgICAgICAgdGhpcy5pbnNpZGVTeW50YXhUZW1wbGF0ZS5wb3AoKTtcbiAgICAgICAgfVxuICAgICAgICBicmVhaztcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGxldCBzdHggPSBuZXcgU3ludGF4KHRvaywgdGhpcy5jb250ZXh0KTtcbiAgICAgICAgcHJlZml4Xzc0OCA9IHByZWZpeF83NDguY29uY2F0KHN0eCk7XG4gICAgICAgIHN0YWNrXzc0NS5wdXNoKHN0eCk7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBMaXN0KHN0YWNrXzc0NSk7XG4gIH1cbiAgYWR2YW5jZShwcmVmaXhfNzQ5LCBiXzc1MCkge1xuICAgIGxldCBzdGFydExvY2F0aW9uXzc1MSA9IHRoaXMuZ2V0TG9jYXRpb24oKTtcbiAgICB0aGlzLmxhc3RJbmRleCA9IHRoaXMuaW5kZXg7XG4gICAgdGhpcy5sYXN0TGluZSA9IHRoaXMubGluZTtcbiAgICB0aGlzLmxhc3RMaW5lU3RhcnQgPSB0aGlzLmxpbmVTdGFydDtcbiAgICB0aGlzLnNraXBDb21tZW50KCk7XG4gICAgdGhpcy5zdGFydEluZGV4ID0gdGhpcy5pbmRleDtcbiAgICB0aGlzLnN0YXJ0TGluZSA9IHRoaXMubGluZTtcbiAgICB0aGlzLnN0YXJ0TGluZVN0YXJ0ID0gdGhpcy5saW5lU3RhcnQ7XG4gICAgaWYgKHRoaXMucmVwbGFjZW1lbnRJbmRleCAmJiB0aGlzLnJlcGxhY2VtZW50SW5kZXhbMF0gJiYgdGhpcy5pbmRleCA+PSB0aGlzLnJlcGxhY2VtZW50SW5kZXhbMF0uaW5kZXgpIHtcbiAgICAgIGxldCByZXAgPSB0aGlzLnJlcGxhY2VtZW50SW5kZXhbMF0ucmVwbGFjZW1lbnQ7XG4gICAgICB0aGlzLnJlcGxhY2VtZW50SW5kZXguc2hpZnQoKTtcbiAgICAgIHJldHVybiByZXA7XG4gICAgfVxuICAgIGxldCBjaGFyQ29kZV83NTIgPSB0aGlzLnNvdXJjZS5jaGFyQ29kZUF0KHRoaXMuaW5kZXgpO1xuICAgIGlmIChjaGFyQ29kZV83NTIgPT09IDk2KSB7XG4gICAgICBsZXQgZWxlbWVudCwgaXRlbXMgPSBbXTtcbiAgICAgIGxldCBzdGFydExvY2F0aW9uXzc1MSA9IHRoaXMuZ2V0TG9jYXRpb24oKTtcbiAgICAgIGxldCBzdGFydCA9IHRoaXMuaW5kZXg7XG4gICAgICB0aGlzLmluZGV4Kys7XG4gICAgICBpZiAobGFzdEVsXzY4Myh0aGlzLmluc2lkZVN5bnRheFRlbXBsYXRlKSkge1xuICAgICAgICBsZXQgc2xpY2UgPSB0aGlzLmdldFNsaWNlKHN0YXJ0LCBzdGFydExvY2F0aW9uXzc1MSk7XG4gICAgICAgIHJldHVybiB7dHlwZTogUlNZTlRBWF82MjgsIHZhbHVlOiBcImBcIiwgc2xpY2U6IHNsaWNlfTtcbiAgICAgIH1cbiAgICAgIGRvIHtcbiAgICAgICAgZWxlbWVudCA9IHRoaXMuc2NhblRlbXBsYXRlRWxlbWVudCgpO1xuICAgICAgICBpdGVtcy5wdXNoKGVsZW1lbnQpO1xuICAgICAgICBpZiAoZWxlbWVudC5pbnRlcnApIHtcbiAgICAgICAgICBlbGVtZW50ID0gdGhpcy5yZWFkKFtdLCBmYWxzZSwgdHJ1ZSk7XG4gICAgICAgICAgYXNzZXJ0KGVsZW1lbnQuc2l6ZSA9PT0gMSwgXCJzaG91bGQgb25seSBoYXZlIHJlYWQgYSBzaW5nbGUgZGVsaW1pdGVyIGluc2lkZSBhIHRlbXBsYXRlXCIpO1xuICAgICAgICAgIGl0ZW1zLnB1c2goZWxlbWVudC5nZXQoMCkpO1xuICAgICAgICB9XG4gICAgICB9IHdoaWxlICghZWxlbWVudC50YWlsKTtcbiAgICAgIHJldHVybiB7dHlwZTogVG9rZW5UeXBlLlRFTVBMQVRFLCBpdGVtczogTGlzdChpdGVtcyl9O1xuICAgIH0gZWxzZSBpZiAoY2hhckNvZGVfNzUyID09PSAzNSkge1xuICAgICAgbGV0IHN0YXJ0TG9jYXRpb25fNzUxID0gdGhpcy5nZXRMb2NhdGlvbigpO1xuICAgICAgbGV0IHN0YXJ0ID0gdGhpcy5pbmRleDtcbiAgICAgIGxldCBzbGljZSA9IHRoaXMuZ2V0U2xpY2Uoc3RhcnQsIHN0YXJ0TG9jYXRpb25fNzUxKTtcbiAgICAgIHRoaXMuaW5kZXgrKztcbiAgICAgIGlmICh0aGlzLnNvdXJjZS5jaGFyQ29kZUF0KHRoaXMuaW5kZXgpID09PSA5Nikge1xuICAgICAgICB0aGlzLmluZGV4Kys7XG4gICAgICAgIHJldHVybiB7dHlwZTogTFNZTlRBWF82MjcsIHZhbHVlOiBcIiNgXCIsIHNsaWNlOiBzbGljZX07XG4gICAgICB9XG4gICAgICByZXR1cm4ge3R5cGU6IFRva2VuVHlwZS5JREVOVElGSUVSLCB2YWx1ZTogXCIjXCIsIHNsaWNlOiBzbGljZX07XG4gICAgfSBlbHNlIGlmIChjaGFyQ29kZV83NTIgPT09IDY0KSB7XG4gICAgICBsZXQgc3RhcnRMb2NhdGlvbl83NTEgPSB0aGlzLmdldExvY2F0aW9uKCk7XG4gICAgICBsZXQgc3RhcnQgPSB0aGlzLmluZGV4O1xuICAgICAgbGV0IHNsaWNlID0gdGhpcy5nZXRTbGljZShzdGFydCwgc3RhcnRMb2NhdGlvbl83NTEpO1xuICAgICAgdGhpcy5pbmRleCsrO1xuICAgICAgcmV0dXJuIHt0eXBlOiBBVF82MjksIHZhbHVlOiBcIkBcIiwgc2xpY2U6IHNsaWNlfTtcbiAgICB9XG4gICAgbGV0IGxvb2thaGVhZF83NTMgPSBzdXBlci5hZHZhbmNlKCk7XG4gICAgaWYgKGxvb2thaGVhZF83NTMudHlwZSA9PT0gVG9rZW5UeXBlLkRJViAmJiBpc1JlZ2V4UHJlZml4XzY4MihiXzc1MCkocHJlZml4Xzc0OSkpIHtcbiAgICAgIHJldHVybiBzdXBlci5zY2FuUmVnRXhwKFwiL1wiKTtcbiAgICB9XG4gICAgcmV0dXJuIGxvb2thaGVhZF83NTM7XG4gIH1cbiAgc2NhblRlbXBsYXRlRWxlbWVudCgpIHtcbiAgICBsZXQgc3RhcnRMb2NhdGlvbl83NTQgPSB0aGlzLmdldExvY2F0aW9uKCk7XG4gICAgbGV0IHN0YXJ0Xzc1NSA9IHRoaXMuaW5kZXg7XG4gICAgd2hpbGUgKHRoaXMuaW5kZXggPCB0aGlzLnNvdXJjZS5sZW5ndGgpIHtcbiAgICAgIGxldCBjaCA9IHRoaXMuc291cmNlLmNoYXJDb2RlQXQodGhpcy5pbmRleCk7XG4gICAgICBzd2l0Y2ggKGNoKSB7XG4gICAgICAgIGNhc2UgOTY6XG4gICAgICAgICAgbGV0IHNsaWNlID0gdGhpcy5nZXRTbGljZShzdGFydF83NTUsIHN0YXJ0TG9jYXRpb25fNzU0KTtcbiAgICAgICAgICB0aGlzLmluZGV4Kys7XG4gICAgICAgICAgcmV0dXJuIHt0eXBlOiBUb2tlblR5cGUuVEVNUExBVEUsIHRhaWw6IHRydWUsIGludGVycDogZmFsc2UsIHNsaWNlOiBzbGljZX07XG4gICAgICAgIGNhc2UgMzY6XG4gICAgICAgICAgaWYgKHRoaXMuc291cmNlLmNoYXJDb2RlQXQodGhpcy5pbmRleCArIDEpID09PSAxMjMpIHtcbiAgICAgICAgICAgIGxldCBzbGljZSA9IHRoaXMuZ2V0U2xpY2Uoc3RhcnRfNzU1LCBzdGFydExvY2F0aW9uXzc1NCk7XG4gICAgICAgICAgICB0aGlzLmluZGV4ICs9IDE7XG4gICAgICAgICAgICByZXR1cm4ge3R5cGU6IFRva2VuVHlwZS5URU1QTEFURSwgdGFpbDogZmFsc2UsIGludGVycDogdHJ1ZSwgc2xpY2U6IHNsaWNlfTtcbiAgICAgICAgICB9XG4gICAgICAgICAgdGhpcy5pbmRleCsrO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIDkyOlxuICAgICAgICAgIHtcbiAgICAgICAgICAgIGxldCBvY3RhbCA9IHRoaXMuc2NhblN0cmluZ0VzY2FwZShcIlwiLCBudWxsKVsxXTtcbiAgICAgICAgICAgIGlmIChvY3RhbCAhPSBudWxsKSB7XG4gICAgICAgICAgICAgIHRocm93IHRoaXMuY3JlYXRlSUxMRUdBTCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgIHRoaXMuaW5kZXgrKztcbiAgICAgIH1cbiAgICB9XG4gICAgdGhyb3cgdGhpcy5jcmVhdGVJTExFR0FMKCk7XG4gIH1cbn1cbiJdfQ==