"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});

var _tokenizer = require("shift-parser/dist/tokenizer");

var _tokenizer2 = _interopRequireDefault(_tokenizer);

var _immutable = require("immutable");

var _syntax = require("./syntax");

var _syntax2 = _interopRequireDefault(_syntax);

var _ramdaFantasy = require("ramda-fantasy");

var _errors = require("./errors");

var _terms = require("./terms");

var _terms2 = _interopRequireDefault(_terms);

var _ramda = require("ramda");

var R = _interopRequireWildcard(_ramda);

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

const Just_616 = _ramdaFantasy.Maybe.Just;
const Nothing_617 = _ramdaFantasy.Maybe.Nothing;
const LSYNTAX_618 = { name: "left-syntax" };
const RSYNTAX_619 = { name: "right-syntax" };
const AT_620 = { klass: _tokenizer.TokenClass.Punctuator, name: "@" };
const literalKeywords_621 = ["this", "null", "true", "false"];
const isLeftBracket_622 = R.whereEq({ type: _tokenizer.TokenType.LBRACK });
const isLeftBrace_623 = R.whereEq({ type: _tokenizer.TokenType.LBRACE });
const isLeftParen_624 = R.whereEq({ type: _tokenizer.TokenType.LPAREN });
const isRightBracket_625 = R.whereEq({ type: _tokenizer.TokenType.RBRACK });
const isRightBrace_626 = R.whereEq({ type: _tokenizer.TokenType.RBRACE });
const isRightParen_627 = R.whereEq({ type: _tokenizer.TokenType.RPAREN });
const isEOS_628 = R.whereEq({ type: _tokenizer.TokenType.EOS });
const isHash_629 = R.whereEq({ type: _tokenizer.TokenType.IDENTIFIER, value: "#" });
const isLeftSyntax_630 = R.whereEq({ type: LSYNTAX_618 });
const isRightSyntax_631 = R.whereEq({ type: RSYNTAX_619 });
const isLeftDelimiter_632 = R.anyPass([isLeftBracket_622, isLeftBrace_623, isLeftParen_624, isLeftSyntax_630]);
const isRightDelimiter_633 = R.anyPass([isRightBracket_625, isRightBrace_626, isRightParen_627, isRightSyntax_631]);
const isMatchingDelimiters_634 = R.cond([[isLeftBracket_622, (__675, b_676) => isRightBracket_625(b_676)], [isLeftBrace_623, (__677, b_678) => isRightBrace_626(b_678)], [isLeftParen_624, (__679, b_680) => isRightParen_627(b_680)], [isLeftSyntax_630, (__681, b_682) => isRightSyntax_631(b_682)], [R.T, R.F]]);
const assignOps_635 = ["=", "+=", "-=", "*=", "/=", "%=", "<<=", ">>=", ">>>=", "&=", "|=", "^=", ","];
const binaryOps_636 = ["+", "-", "*", "/", "%", "<<", ">>", ">>>", "&", "|", "^", "&&", "||", "?", ":", "===", "==", ">=", "<=", "<", ">", "!=", "!==", "instanceof"];
const unaryOps_637 = ["++", "--", "~", "!", "delete", "void", "typeof", "yield", "throw", "new"];
const isEmpty_638 = R.whereEq({ size: 0 });
const isPunctuator_639 = s_683 => s_683.match("punctuator");
const isKeyword_640 = s_684 => s_684.match("keyword");
const isDelimiter_641 = s_685 => s_685.match("delimiter");
const isParens_642 = s_686 => s_686.match("parens");
const isBraces_643 = s_687 => s_687.match("braces");
const isBrackets_644 = s_688 => s_688.match("brackets");
const isIdentifier_645 = s_689 => s_689.match("identifier");
const val_646 = s_690 => s_690.val();
const isVal_647 = R.curry((v_691, s_692) => s_692.val() === v_691);
const isDot_648 = R.allPass([isPunctuator_639, isVal_647(".")]);
const isColon_649 = R.allPass([isPunctuator_639, isVal_647(":")]);
const isFunctionKeyword_650 = R.allPass([isKeyword_640, isVal_647("function")]);
const isOperator_651 = s_693 => (s_693.match("punctuator") || s_693.match("keyword")) && R.any(R.equals(s_693.val()), assignOps_635.concat(binaryOps_636).concat(unaryOps_637));
const isNonLiteralKeyword_652 = R.allPass([isKeyword_640, s_694 => R.none(R.equals(s_694.val()), literalKeywords_621)]);
const isKeywordExprPrefix_653 = R.allPass([isKeyword_640, s_695 => R.any(R.equals(s_695.val()), ["instanceof", "typeof", "delete", "void", "yield", "throw", "new", "case"])]);
let last_654 = p_696 => p_696.last();
let safeLast_655 = R.pipe(R.cond([[isEmpty_638, R.always(Nothing_617())], [R.T, R.compose(_ramdaFantasy.Maybe.of, last_654)]]));
let stuffTrue_656 = R.curry((p_697, b_698) => b_698 ? Just_616(p_697) : Nothing_617());
let stuffFalse_657 = R.curry((p_699, b_700) => !b_700 ? Just_616(p_699) : Nothing_617());
let isTopColon_658 = R.pipe(safeLast_655, R.map(isColon_649), _ramdaFantasy.Maybe.maybe(false, R.identity));
let isTopPunctuator_659 = R.pipe(safeLast_655, R.map(isPunctuator_639), _ramdaFantasy.Maybe.maybe(false, R.identity));
let isExprReturn_660 = R.curry((l_701, p_702) => {
  let retKwd_703 = safeLast_655(p_702);
  let maybeDot_704 = pop_671(p_702).chain(safeLast_655);
  if (maybeDot_704.map(isDot_648).getOrElse(false)) {
    return true;
  }
  return retKwd_703.map(s_705 => {
    return s_705.match("keyword") && s_705.val() === "return" && s_705.lineNumber() === l_701;
  }).getOrElse(false);
});
const isTopOperator_661 = R.pipe(safeLast_655, R.map(isOperator_651), _ramdaFantasy.Maybe.maybe(false, R.identity));
const isTopKeywordExprPrefix_662 = R.pipe(safeLast_655, R.map(isKeywordExprPrefix_653), _ramdaFantasy.Maybe.maybe(false, R.identity));
let isExprPrefix_663 = R.curry((l_706, b_707) => R.cond([[isEmpty_638, R.always(b_707)], [isTopColon_658, R.always(b_707)], [isTopKeywordExprPrefix_662, R.T], [isTopOperator_661, R.T], [isTopPunctuator_659, R.always(b_707)], [isExprReturn_660(l_706), R.T], [R.T, R.F]]));
let curly_664 = p_708 => safeLast_655(p_708).map(isBraces_643).chain(stuffTrue_656(p_708));
let paren_665 = p_709 => safeLast_655(p_709).map(isParens_642).chain(stuffTrue_656(p_709));
let func_666 = p_710 => safeLast_655(p_710).map(isFunctionKeyword_650).chain(stuffTrue_656(p_710));
let ident_667 = p_711 => safeLast_655(p_711).map(isIdentifier_645).chain(stuffTrue_656(p_711));
let nonLiteralKeyword_668 = p_712 => safeLast_655(p_712).map(isNonLiteralKeyword_652).chain(stuffTrue_656(p_712));
let opt_669 = R.curry((a_713, b_714, p_715) => {
  let result_716 = R.pipeK(a_713, b_714)(_ramdaFantasy.Maybe.of(p_715));
  return _ramdaFantasy.Maybe.isJust(result_716) ? result_716 : _ramdaFantasy.Maybe.of(p_715);
});
let notDot_670 = R.ifElse(R.whereEq({ size: 0 }), Just_616, p_717 => safeLast_655(p_717).map(s_718 => !(s_718.match("punctuator") && s_718.val() === ".")).chain(stuffTrue_656(p_717)));
let pop_671 = R.compose(Just_616, p_719 => p_719.pop());
const functionPrefix_672 = R.pipeK(curly_664, pop_671, paren_665, pop_671, opt_669(ident_667, pop_671), func_666);
const isRegexPrefix_673 = b_720 => R.anyPass([isEmpty_638, isTopPunctuator_659, R.pipe(_ramdaFantasy.Maybe.of, R.pipeK(nonLiteralKeyword_668, pop_671, notDot_670), _ramdaFantasy.Maybe.isJust), R.pipe(_ramdaFantasy.Maybe.of, R.pipeK(paren_665, pop_671, nonLiteralKeyword_668, pop_671, notDot_670), _ramdaFantasy.Maybe.isJust), R.pipe(_ramdaFantasy.Maybe.of, functionPrefix_672, R.chain(p_721 => {
  return safeLast_655(p_721).map(s_722 => s_722.lineNumber()).chain(fnLine_723 => {
    return pop_671(p_721).map(isExprPrefix_663(fnLine_723, b_720));
  }).chain(stuffFalse_657(p_721));
}), _ramdaFantasy.Maybe.isJust), p_724 => {
  let isCurly_725 = _ramdaFantasy.Maybe.isJust(safeLast_655(p_724).map(isBraces_643));
  let alreadyCheckedFunction_726 = R.pipe(_ramdaFantasy.Maybe.of, functionPrefix_672, _ramdaFantasy.Maybe.isJust)(p_724);
  if (alreadyCheckedFunction_726) {
    return false;
  }
  return R.pipe(_ramdaFantasy.Maybe.of, R.chain(curly_664), R.chain(p_727 => {
    return safeLast_655(p_727).map(s_728 => s_728.lineNumber()).chain(curlyLine_729 => {
      return pop_671(p_727).map(isExprPrefix_663(curlyLine_729, b_720));
    }).chain(stuffFalse_657(p_727));
  }), _ramdaFantasy.Maybe.isJust)(p_724);
}]);
function lastEl_674(l_730) {
  return l_730[l_730.length - 1];
}
class Reader extends _tokenizer2.default {
  constructor(strings_731, context_732, replacements_733) {
    super(Array.isArray(strings_731) ? strings_731.join("") : strings_731);
    this.delimStack = new Map();
    this.insideSyntaxTemplate = [false];
    this.context = context_732;
    if (Array.isArray(strings_731)) {
      let totalIndex = 0;
      this.replacementIndex = R.reduce((acc_734, strRep_735) => {
        acc_734.push({ index: totalIndex + strRep_735[0].length, replacement: strRep_735[1] });
        totalIndex += strRep_735[0].length;
        return acc_734;
      }, [], R.zip(strings_731, replacements_733));
    }
  }
  read() {
    let stack_736 = arguments.length <= 0 || arguments[0] === undefined ? [] : arguments[0];
    let b_737 = arguments.length <= 1 || arguments[1] === undefined ? false : arguments[1];
    let singleDelimiter_738 = arguments.length <= 2 || arguments[2] === undefined ? false : arguments[2];

    let prefix_739 = (0, _immutable.List)();
    while (true) {
      let tok = this.advance(prefix_739, b_737);
      if (tok instanceof _syntax2.default || tok instanceof _terms2.default) {
        stack_736.push(tok);
        continue;
      }
      if (Array.isArray(tok)) {
        Array.prototype.push.apply(stack_736, tok);
        continue;
      }
      if (_immutable.List.isList(tok)) {
        Array.prototype.push.apply(stack_736, tok.toArray());
        continue;
      }
      if (isEOS_628(tok)) {
        if (stack_736[0] && isLeftDelimiter_632(stack_736[0].token)) {
          throw this.createUnexpected(tok);
        }
        break;
      }
      if (isLeftDelimiter_632(tok)) {
        if (isLeftSyntax_630(tok)) {
          this.insideSyntaxTemplate.push(true);
        }
        let line = tok.slice.startLocation.line;
        let innerB = isLeftBrace_623(tok) ? isExprPrefix_663(line, b_737)(prefix_739) : true;
        let inner = this.read([new _syntax2.default(tok, this.context)], innerB, false);
        let stx = new _syntax2.default(inner, this.context);
        prefix_739 = prefix_739.concat(stx);
        stack_736.push(stx);
        if (singleDelimiter_738) {
          break;
        }
      } else if (isRightDelimiter_633(tok)) {
        if (stack_736[0] && !isMatchingDelimiters_634(stack_736[0].token, tok)) {
          throw this.createUnexpected(tok);
        }
        let stx = new _syntax2.default(tok, this.context);
        stack_736.push(stx);
        if (lastEl_674(this.insideSyntaxTemplate) && isRightSyntax_631(tok)) {
          this.insideSyntaxTemplate.pop();
        }
        break;
      } else {
        let stx = new _syntax2.default(tok, this.context);
        prefix_739 = prefix_739.concat(stx);
        stack_736.push(stx);
      }
    }
    return (0, _immutable.List)(stack_736);
  }
  advance(prefix_740, b_741) {
    let startLocation_742 = this.getLocation();
    this.lastIndex = this.index;
    this.lastLine = this.line;
    this.lastLineStart = this.lineStart;
    this.skipComment();
    this.startIndex = this.index;
    this.startLine = this.line;
    this.startLineStart = this.lineStart;
    if (this.replacementIndex && this.replacementIndex[0] && this.index >= this.replacementIndex[0].index) {
      let rep = this.replacementIndex[0].replacement;
      this.replacementIndex.shift();
      return rep;
    }
    let charCode_743 = this.source.charCodeAt(this.index);
    if (charCode_743 === 96) {
      let element,
          items = [];
      let startLocation_742 = this.getLocation();
      let start = this.index;
      this.index++;
      if (lastEl_674(this.insideSyntaxTemplate)) {
        let slice = this.getSlice(start, startLocation_742);
        return { type: RSYNTAX_619, value: "`", slice: slice };
      }
      do {
        element = this.scanTemplateElement();
        items.push(element);
        if (element.interp) {
          element = this.read([], false, true);
          (0, _errors.assert)(element.size === 1, "should only have read a single delimiter inside a template");
          items.push(element.get(0));
        }
      } while (!element.tail);
      return { type: _tokenizer.TokenType.TEMPLATE, items: (0, _immutable.List)(items) };
    } else if (charCode_743 === 35) {
      let startLocation_742 = this.getLocation();
      let start = this.index;
      let slice = this.getSlice(start, startLocation_742);
      this.index++;
      if (this.source.charCodeAt(this.index) === 96) {
        this.index++;
        return { type: LSYNTAX_618, value: "#`", slice: slice };
      }
      return { type: _tokenizer.TokenType.IDENTIFIER, value: "#", slice: slice };
    } else if (charCode_743 === 64) {
      let startLocation_742 = this.getLocation();
      let start = this.index;
      let slice = this.getSlice(start, startLocation_742);
      this.index++;
      return { type: AT_620, value: "@", slice: slice };
    }
    let lookahead_744 = super.advance();
    if (lookahead_744.type === _tokenizer.TokenType.DIV && isRegexPrefix_673(b_741)(prefix_740)) {
      return super.scanRegExp("/");
    }
    return lookahead_744;
  }
  scanTemplateElement() {
    let startLocation_745 = this.getLocation();
    let start_746 = this.index;
    while (this.index < this.source.length) {
      let ch = this.source.charCodeAt(this.index);
      switch (ch) {
        case 96:
          let slice = this.getSlice(start_746, startLocation_745);
          this.index++;
          return { type: _tokenizer.TokenType.TEMPLATE, tail: true, interp: false, slice: slice };
        case 36:
          if (this.source.charCodeAt(this.index + 1) === 123) {
            let slice = this.getSlice(start_746, startLocation_745);
            this.index += 1;
            return { type: _tokenizer.TokenType.TEMPLATE, tail: false, interp: true, slice: slice };
          }
          this.index++;
          break;
        case 92:
          {
            let octal = this.scanStringEscape("", null)[1];
            if (octal != null) {
              throw this.createILLEGAL();
            }
            break;
          }
        default:
          this.index++;
      }
    }
    throw this.createILLEGAL();
  }
}
exports.default = Reader;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3N3ZWV0L3NoaWZ0LXJlYWRlci5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQTs7OztBQUVBOztBQUNBOzs7O0FBQ0E7O0FBQ0E7O0FBQ0E7Ozs7QUFDQTs7SUFBYSxDOzs7Ozs7QUFDYixNQUFNLFdBQVcsb0JBQU0sSUFBdkI7QUFDQSxNQUFNLGNBQWMsb0JBQU0sT0FBMUI7QUFDQSxNQUFNLGNBQWMsRUFBQyxNQUFNLGFBQVAsRUFBcEI7QUFDQSxNQUFNLGNBQWMsRUFBQyxNQUFNLGNBQVAsRUFBcEI7QUFDQSxNQUFNLFNBQVMsRUFBQyxPQUFPLHNCQUFXLFVBQW5CLEVBQStCLE1BQU0sR0FBckMsRUFBZjtBQUNBLE1BQU0sc0JBQXNCLENBQUMsTUFBRCxFQUFTLE1BQVQsRUFBaUIsTUFBakIsRUFBeUIsT0FBekIsQ0FBNUI7QUFDQSxNQUFNLG9CQUFvQixFQUFFLE9BQUYsQ0FBVSxFQUFDLE1BQU0scUJBQVUsTUFBakIsRUFBVixDQUExQjtBQUNBLE1BQU0sa0JBQWtCLEVBQUUsT0FBRixDQUFVLEVBQUMsTUFBTSxxQkFBVSxNQUFqQixFQUFWLENBQXhCO0FBQ0EsTUFBTSxrQkFBa0IsRUFBRSxPQUFGLENBQVUsRUFBQyxNQUFNLHFCQUFVLE1BQWpCLEVBQVYsQ0FBeEI7QUFDQSxNQUFNLHFCQUFxQixFQUFFLE9BQUYsQ0FBVSxFQUFDLE1BQU0scUJBQVUsTUFBakIsRUFBVixDQUEzQjtBQUNBLE1BQU0sbUJBQW1CLEVBQUUsT0FBRixDQUFVLEVBQUMsTUFBTSxxQkFBVSxNQUFqQixFQUFWLENBQXpCO0FBQ0EsTUFBTSxtQkFBbUIsRUFBRSxPQUFGLENBQVUsRUFBQyxNQUFNLHFCQUFVLE1BQWpCLEVBQVYsQ0FBekI7QUFDQSxNQUFNLFlBQVksRUFBRSxPQUFGLENBQVUsRUFBQyxNQUFNLHFCQUFVLEdBQWpCLEVBQVYsQ0FBbEI7QUFDQSxNQUFNLGFBQWEsRUFBRSxPQUFGLENBQVUsRUFBQyxNQUFNLHFCQUFVLFVBQWpCLEVB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O0FBQ0U7QUFDRSxnQkFBSSxRQUFRLEtBQUssZ0JBQUwsQ0FBc0IsRUFBdEIsRUFBMEIsSUFBMUIsRUFBZ0MsQ0FBaEMsQ0FBWjtBQUNBLGdCQUFJLFNBQVMsSUFBYixFQUFtQjtBQUNqQixvQkFBTSxLQUFLLGFBQUwsRUFBTjtBQUNEO0FBQ0Q7QUFDRDtBQUNIO0FBQ0UsZUFBSyxLQUFMO0FBdEJKO0FBd0JEO0FBQ0QsVUFBTSxLQUFLLGFBQUwsRUFBTjtBQUNEO0FBNUoyQztrQkFBekIsTSIsImZpbGUiOiJzaGlmdC1yZWFkZXIuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgVG9rZW5pemVyIGZyb20gXCJzaGlmdC1wYXJzZXIvZGlzdC90b2tlbml6ZXJcIjtcbmltcG9ydCB7VG9rZW5DbGFzcywgVG9rZW5UeXBlfSBmcm9tIFwic2hpZnQtcGFyc2VyL2Rpc3QvdG9rZW5pemVyXCI7XG5pbXBvcnQge0xpc3R9IGZyb20gXCJpbW11dGFibGVcIjtcbmltcG9ydCBTeW50YXggZnJvbSBcIi4vc3ludGF4XCI7XG5pbXBvcnQge01heWJlfSBmcm9tIFwicmFtZGEtZmFudGFzeVwiO1xuaW1wb3J0IHthc3NlcnR9IGZyb20gXCIuL2Vycm9yc1wiO1xuaW1wb3J0IFRlcm0gZnJvbSBcIi4vdGVybXNcIjtcbmltcG9ydCAgKiBhcyBSIGZyb20gXCJyYW1kYVwiO1xuY29uc3QgSnVzdF82MTYgPSBNYXliZS5KdXN0O1xuY29uc3QgTm90aGluZ182MTcgPSBNYXliZS5Ob3RoaW5nO1xuY29uc3QgTFNZTlRBWF82MTggPSB7bmFtZTogXCJsZWZ0LXN5bnRheFwifTtcbmNvbnN0IFJTWU5UQVhfNjE5ID0ge25hbWU6IFwicmlnaHQtc3ludGF4XCJ9O1xuY29uc3QgQVRfNjIwID0ge2tsYXNzOiBUb2tlbkNsYXNzLlB1bmN0dWF0b3IsIG5hbWU6IFwiQFwifTtcbmNvbnN0IGxpdGVyYWxLZXl3b3Jkc182MjEgPSBbXCJ0aGlzXCIsIFwibnVsbFwiLCBcInRydWVcIiwgXCJmYWxzZVwiXTtcbmNvbnN0IGlzTGVmdEJyYWNrZXRfNjIyID0gUi53aGVyZUVxKHt0eXBlOiBUb2tlblR5cGUuTEJSQUNLfSk7XG5jb25zdCBpc0xlZnRCcmFjZV82MjMgPSBSLndoZXJlRXEoe3R5cGU6IFRva2VuVHlwZS5MQlJBQ0V9KTtcbmNvbnN0IGlzTGVmdFBhcmVuXzYyNCA9IFIud2hlcmVFcSh7dHlwZTogVG9rZW5UeXBlLkxQQVJFTn0pO1xuY29uc3QgaXNSaWdodEJyYWNrZXRfNjI1ID0gUi53aGVyZUVxKHt0eXBlOiBUb2tlblR5cGUuUkJSQUNLfSk7XG5jb25zdCBpc1JpZ2h0QnJhY2VfNjI2ID0gUi53aGVyZUVxKHt0eXBlOiBUb2tlblR5cGUuUkJSQUNFfSk7XG5jb25zdCBpc1JpZ2h0UGFyZW5fNjI3ID0gUi53aGVyZUVxKHt0eXBlOiBUb2tlblR5cGUuUlBBUkVOfSk7XG5jb25zdCBpc0VPU182MjggPSBSLndoZXJlRXEoe3R5cGU6IFRva2VuVHlwZS5FT1N9KTtcbmNvbnN0IGlzSGFzaF82MjkgPSBSLndoZXJlRXEoe3R5cGU6IFRva2VuVHlwZS5JREVOVElGSUVSLCB2YWx1ZTogXCIjXCJ9KTtcbmNvbnN0IGlzTGVmdFN5bnRheF82MzAgPSBSLndoZXJlRXEoe3R5cGU6IExTWU5UQVhfNjE4fSk7XG5jb25zdCBpc1JpZ2h0U3ludGF4XzYzMSA9IFIud2hlcmVFcSh7dHlwZTogUlNZTlRBWF82MTl9KTtcbmNvbnN0IGlzTGVmdERlbGltaXRlcl82MzIgPSBSLmFueVBhc3MoW2lzTGVmdEJyYWNrZXRfNjIyLCBpc0xlZnRCcmFjZV82MjMsIGlzTGVmdFBhcmVuXzYyNCwgaXNMZWZ0U3ludGF4XzYzMF0pO1xuY29uc3QgaXNSaWdodERlbGltaXRlcl82MzMgPSBSLmFueVBhc3MoW2lzUmlnaHRCcmFja2V0XzYyNSwgaXNSaWdodEJyYWNlXzYyNiwgaXNSaWdodFBhcmVuXzYyNywgaXNSaWdodFN5bnRheF82MzFdKTtcbmNvbnN0IGlzTWF0Y2hpbmdEZWxpbWl0ZXJzXzYzNCA9IFIuY29uZChbW2lzTGVmdEJyYWNrZXRfNjIyLCAoX182NzUsIGJfNjc2KSA9PiBpc1JpZ2h0QnJhY2tldF82MjUoYl82NzYpXSwgW2lzTGVmdEJyYWNlXzYyMywgKF9fNjc3LCBiXzY3OCkgPT4gaXNSaWdodEJyYWNlXzYyNihiXzY3OCldLCBbaXNMZWZ0UGFyZW5fNjI0LCAoX182NzksIGJfNjgwKSA9PiBpc1JpZ2h0UGFyZW5fNjI3KGJfNjgwKV0sIFtpc0xlZnRTeW50YXhfNjMwLCAoX182ODEsIGJfNjgyKSA9PiBpc1JpZ2h0U3ludGF4XzYzMShiXzY4MildLCBbUi5ULCBSLkZdXSk7XG5jb25zdCBhc3NpZ25PcHNfNjM1ID0gW1wiPVwiLCBcIis9XCIsIFwiLT1cIiwgXCIqPVwiLCBcIi89XCIsIFwiJT1cIiwgXCI8PD1cIiwgXCI+Pj1cIiwgXCI+Pj49XCIsIFwiJj1cIiwgXCJ8PVwiLCBcIl49XCIsIFwiLFwiXTtcbmNvbnN0IGJpbmFyeU9wc182MzYgPSBbXCIrXCIsIFwiLVwiLCBcIipcIiwgXCIvXCIsIFwiJVwiLCBcIjw8XCIsIFwiPj5cIiwgXCI+Pj5cIiwgXCImXCIsIFwifFwiLCBcIl5cIiwgXCImJlwiLCBcInx8XCIsIFwiP1wiLCBcIjpcIiwgXCI9PT1cIiwgXCI9PVwiLCBcIj49XCIsIFwiPD1cIiwgXCI8XCIsIFwiPlwiLCBcIiE9XCIsIFwiIT09XCIsIFwiaW5zdGFuY2VvZlwiXTtcbmNvbnN0IHVuYXJ5T3BzXzYzNyA9IFtcIisrXCIsIFwiLS1cIiwgXCJ+XCIsIFwiIVwiLCBcImRlbGV0ZVwiLCBcInZvaWRcIiwgXCJ0eXBlb2ZcIiwgXCJ5aWVsZFwiLCBcInRocm93XCIsIFwibmV3XCJdO1xuY29uc3QgaXNFbXB0eV82MzggPSBSLndoZXJlRXEoe3NpemU6IDB9KTtcbmNvbnN0IGlzUHVuY3R1YXRvcl82MzkgPSBzXzY4MyA9PiBzXzY4My5tYXRjaChcInB1bmN0dWF0b3JcIik7XG5jb25zdCBpc0tleXdvcmRfNjQwID0gc182ODQgPT4gc182ODQubWF0Y2goXCJrZXl3b3JkXCIpO1xuY29uc3QgaXNEZWxpbWl0ZXJfNjQxID0gc182ODUgPT4gc182ODUubWF0Y2goXCJkZWxpbWl0ZXJcIik7XG5jb25zdCBpc1BhcmVuc182NDIgPSBzXzY4NiA9PiBzXzY4Ni5tYXRjaChcInBhcmVuc1wiKTtcbmNvbnN0IGlzQnJhY2VzXzY0MyA9IHNfNjg3ID0+IHNfNjg3Lm1hdGNoKFwiYnJhY2VzXCIpO1xuY29uc3QgaXNCcmFja2V0c182NDQgPSBzXzY4OCA9PiBzXzY4OC5tYXRjaChcImJyYWNrZXRzXCIpO1xuY29uc3QgaXNJZGVudGlmaWVyXzY0NSA9IHNfNjg5ID0+IHNfNjg5Lm1hdGNoKFwiaWRlbnRpZmllclwiKTtcbmNvbnN0IHZhbF82NDYgPSBzXzY5MCA9PiBzXzY5MC52YWwoKTtcbmNvbnN0IGlzVmFsXzY0NyA9IFIuY3VycnkoKHZfNjkxLCBzXzY5MikgPT4gc182OTIudmFsKCkgPT09IHZfNjkxKTtcbmNvbnN0IGlzRG90XzY0OCA9IFIuYWxsUGFzcyhbaXNQdW5jdHVhdG9yXzYzOSwgaXNWYWxfNjQ3KFwiLlwiKV0pO1xuY29uc3QgaXNDb2xvbl82NDkgPSBSLmFsbFBhc3MoW2lzUHVuY3R1YXRvcl82MzksIGlzVmFsXzY0NyhcIjpcIildKTtcbmNvbnN0IGlzRnVuY3Rpb25LZXl3b3JkXzY1MCA9IFIuYWxsUGFzcyhbaXNLZXl3b3JkXzY0MCwgaXNWYWxfNjQ3KFwiZnVuY3Rpb25cIildKTtcbmNvbnN0IGlzT3BlcmF0b3JfNjUxID0gc182OTMgPT4gKHNfNjkzLm1hdGNoKFwicHVuY3R1YXRvclwiKSB8fCBzXzY5My5tYXRjaChcImtleXdvcmRcIikpICYmIFIuYW55KFIuZXF1YWxzKHNfNjkzLnZhbCgpKSwgYXNzaWduT3BzXzYzNS5jb25jYXQoYmluYXJ5T3BzXzYzNikuY29uY2F0KHVuYXJ5T3BzXzYzNykpO1xuY29uc3QgaXNOb25MaXRlcmFsS2V5d29yZF82NTIgPSBSLmFsbFBhc3MoW2lzS2V5d29yZF82NDAsIHNfNjk0ID0+IFIubm9uZShSLmVxdWFscyhzXzY5NC52YWwoKSksIGxpdGVyYWxLZXl3b3Jkc182MjEpXSk7XG5jb25zdCBpc0tleXdvcmRFeHByUHJlZml4XzY1MyA9IFIuYWxsUGFzcyhbaXNLZXl3b3JkXzY0MCwgc182OTUgPT4gUi5hbnkoUi5lcXVhbHMoc182OTUudmFsKCkpLCBbXCJpbnN0YW5jZW9mXCIsIFwidHlwZW9mXCIsIFwiZGVsZXRlXCIsIFwidm9pZFwiLCBcInlpZWxkXCIsIFwidGhyb3dcIiwgXCJuZXdcIiwgXCJjYXNlXCJdKV0pO1xubGV0IGxhc3RfNjU0ID0gcF82OTYgPT4gcF82OTYubGFzdCgpO1xubGV0IHNhZmVMYXN0XzY1NSA9IFIucGlwZShSLmNvbmQoW1tpc0VtcHR5XzYzOCwgUi5hbHdheXMoTm90aGluZ182MTcoKSldLCBbUi5ULCBSLmNvbXBvc2UoTWF5YmUub2YsIGxhc3RfNjU0KV1dKSk7XG5sZXQgc3R1ZmZUcnVlXzY1NiA9IFIuY3VycnkoKHBfNjk3LCBiXzY5OCkgPT4gYl82OTggPyBKdXN0XzYxNihwXzY5NykgOiBOb3RoaW5nXzYxNygpKTtcbmxldCBzdHVmZkZhbHNlXzY1NyA9IFIuY3VycnkoKHBfNjk5LCBiXzcwMCkgPT4gIWJfNzAwID8gSnVzdF82MTYocF82OTkpIDogTm90aGluZ182MTcoKSk7XG5sZXQgaXNUb3BDb2xvbl82NTggPSBSLnBpcGUoc2FmZUxhc3RfNjU1LCBSLm1hcChpc0NvbG9uXzY0OSksIE1heWJlLm1heWJlKGZhbHNlLCBSLmlkZW50aXR5KSk7XG5sZXQgaXNUb3BQdW5jdHVhdG9yXzY1OSA9IFIucGlwZShzYWZlTGFzdF82NTUsIFIubWFwKGlzUHVuY3R1YXRvcl82MzkpLCBNYXliZS5tYXliZShmYWxzZSwgUi5pZGVudGl0eSkpO1xubGV0IGlzRXhwclJldHVybl82NjAgPSBSLmN1cnJ5KChsXzcwMSwgcF83MDIpID0+IHtcbiAgbGV0IHJldEt3ZF83MDMgPSBzYWZlTGFzdF82NTUocF83MDIpO1xuICBsZXQgbWF5YmVEb3RfNzA0ID0gcG9wXzY3MShwXzcwMikuY2hhaW4oc2FmZUxhc3RfNjU1KTtcbiAgaWYgKG1heWJlRG90XzcwNC5tYXAoaXNEb3RfNjQ4KS5nZXRPckVsc2UoZmFsc2UpKSB7XG4gICAgcmV0dXJuIHRydWU7XG4gIH1cbiAgcmV0dXJuIHJldEt3ZF83MDMubWFwKHNfNzA1ID0+IHtcbiAgICByZXR1cm4gc183MDUubWF0Y2goXCJrZXl3b3JkXCIpICYmIHNfNzA1LnZhbCgpID09PSBcInJldHVyblwiICYmIHNfNzA1LmxpbmVOdW1iZXIoKSA9PT0gbF83MDE7XG4gIH0pLmdldE9yRWxzZShmYWxzZSk7XG59KTtcbmNvbnN0IGlzVG9wT3BlcmF0b3JfNjYxID0gUi5waXBlKHNhZmVMYXN0XzY1NSwgUi5tYXAoaXNPcGVyYXRvcl82NTEpLCBNYXliZS5tYXliZShmYWxzZSwgUi5pZGVudGl0eSkpO1xuY29uc3QgaXNUb3BLZXl3b3JkRXhwclByZWZpeF82NjIgPSBSLnBpcGUoc2FmZUxhc3RfNjU1LCBSLm1hcChpc0tleXdvcmRFeHByUHJlZml4XzY1MyksIE1heWJlLm1heWJlKGZhbHNlLCBSLmlkZW50aXR5KSk7XG5sZXQgaXNFeHByUHJlZml4XzY2MyA9IFIuY3VycnkoKGxfNzA2LCBiXzcwNykgPT4gUi5jb25kKFtbaXNFbXB0eV82MzgsIFIuYWx3YXlzKGJfNzA3KV0sIFtpc1RvcENvbG9uXzY1OCwgUi5hbHdheXMoYl83MDcpXSwgW2lzVG9wS2V5d29yZEV4cHJQcmVmaXhfNjYyLCBSLlRdLCBbaXNUb3BPcGVyYXRvcl82NjEsIFIuVF0sIFtpc1RvcFB1bmN0dWF0b3JfNjU5LCBSLmFsd2F5cyhiXzcwNyldLCBbaXNFeHByUmV0dXJuXzY2MChsXzcwNiksIFIuVF0sIFtSLlQsIFIuRl1dKSk7XG5sZXQgY3VybHlfNjY0ID0gcF83MDggPT4gc2FmZUxhc3RfNjU1KHBfNzA4KS5tYXAoaXNCcmFjZXNfNjQzKS5jaGFpbihzdHVmZlRydWVfNjU2KHBfNzA4KSk7XG5sZXQgcGFyZW5fNjY1ID0gcF83MDkgPT4gc2FmZUxhc3RfNjU1KHBfNzA5KS5tYXAoaXNQYXJlbnNfNjQyKS5jaGFpbihzdHVmZlRydWVfNjU2KHBfNzA5KSk7XG5sZXQgZnVuY182NjYgPSBwXzcxMCA9PiBzYWZlTGFzdF82NTUocF83MTApLm1hcChpc0Z1bmN0aW9uS2V5d29yZF82NTApLmNoYWluKHN0dWZmVHJ1ZV82NTYocF83MTApKTtcbmxldCBpZGVudF82NjcgPSBwXzcxMSA9PiBzYWZlTGFzdF82NTUocF83MTEpLm1hcChpc0lkZW50aWZpZXJfNjQ1KS5jaGFpbihzdHVmZlRydWVfNjU2KHBfNzExKSk7XG5sZXQgbm9uTGl0ZXJhbEtleXdvcmRfNjY4ID0gcF83MTIgPT4gc2FmZUxhc3RfNjU1KHBfNzEyKS5tYXAoaXNOb25MaXRlcmFsS2V5d29yZF82NTIpLmNoYWluKHN0dWZmVHJ1ZV82NTYocF83MTIpKTtcbmxldCBvcHRfNjY5ID0gUi5jdXJyeSgoYV83MTMsIGJfNzE0LCBwXzcxNSkgPT4ge1xuICBsZXQgcmVzdWx0XzcxNiA9IFIucGlwZUsoYV83MTMsIGJfNzE0KShNYXliZS5vZihwXzcxNSkpO1xuICByZXR1cm4gTWF5YmUuaXNKdXN0KHJlc3VsdF83MTYpID8gcmVzdWx0XzcxNiA6IE1heWJlLm9mKHBfNzE1KTtcbn0pO1xubGV0IG5vdERvdF82NzAgPSBSLmlmRWxzZShSLndoZXJlRXEoe3NpemU6IDB9KSwgSnVzdF82MTYsIHBfNzE3ID0+IHNhZmVMYXN0XzY1NShwXzcxNykubWFwKHNfNzE4ID0+ICEoc183MTgubWF0Y2goXCJwdW5jdHVhdG9yXCIpICYmIHNfNzE4LnZhbCgpID09PSBcIi5cIikpLmNoYWluKHN0dWZmVHJ1ZV82NTYocF83MTcpKSk7XG5sZXQgcG9wXzY3MSA9IFIuY29tcG9zZShKdXN0XzYxNiwgcF83MTkgPT4gcF83MTkucG9wKCkpO1xuY29uc3QgZnVuY3Rpb25QcmVmaXhfNjcyID0gUi5waXBlSyhjdXJseV82NjQsIHBvcF82NzEsIHBhcmVuXzY2NSwgcG9wXzY3MSwgb3B0XzY2OShpZGVudF82NjcsIHBvcF82NzEpLCBmdW5jXzY2Nik7XG5jb25zdCBpc1JlZ2V4UHJlZml4XzY3MyA9IGJfNzIwID0+IFIuYW55UGFzcyhbaXNFbXB0eV82MzgsIGlzVG9wUHVuY3R1YXRvcl82NTksIFIucGlwZShNYXliZS5vZiwgUi5waXBlSyhub25MaXRlcmFsS2V5d29yZF82NjgsIHBvcF82NzEsIG5vdERvdF82NzApLCBNYXliZS5pc0p1c3QpLCBSLnBpcGUoTWF5YmUub2YsIFIucGlwZUsocGFyZW5fNjY1LCBwb3BfNjcxLCBub25MaXRlcmFsS2V5d29yZF82NjgsIHBvcF82NzEsIG5vdERvdF82NzApLCBNYXliZS5pc0p1c3QpLCBSLnBpcGUoTWF5YmUub2YsIGZ1bmN0aW9uUHJlZml4XzY3MiwgUi5jaGFpbihwXzcyMSA9PiB7XG4gIHJldHVybiBzYWZlTGFzdF82NTUocF83MjEpLm1hcChzXzcyMiA9PiBzXzcyMi5saW5lTnVtYmVyKCkpLmNoYWluKGZuTGluZV83MjMgPT4ge1xuICAgIHJldHVybiBwb3BfNjcxKHBfNzIxKS5tYXAoaXNFeHByUHJlZml4XzY2MyhmbkxpbmVfNzIzLCBiXzcyMCkpO1xuICB9KS5jaGFpbihzdHVmZkZhbHNlXzY1NyhwXzcyMSkpO1xufSksIE1heWJlLmlzSnVzdCksIHBfNzI0ID0+IHtcbiAgbGV0IGlzQ3VybHlfNzI1ID0gTWF5YmUuaXNKdXN0KHNhZmVMYXN0XzY1NShwXzcyNCkubWFwKGlzQnJhY2VzXzY0MykpO1xuICBsZXQgYWxyZWFkeUNoZWNrZWRGdW5jdGlvbl83MjYgPSBSLnBpcGUoTWF5YmUub2YsIGZ1bmN0aW9uUHJlZml4XzY3MiwgTWF5YmUuaXNKdXN0KShwXzcyNCk7XG4gIGlmIChhbHJlYWR5Q2hlY2tlZEZ1bmN0aW9uXzcyNikge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuICByZXR1cm4gUi5waXBlKE1heWJlLm9mLCBSLmNoYWluKGN1cmx5XzY2NCksIFIuY2hhaW4ocF83MjcgPT4ge1xuICAgIHJldHVybiBzYWZlTGFzdF82NTUocF83MjcpLm1hcChzXzcyOCA9PiBzXzcyOC5saW5lTnVtYmVyKCkpLmNoYWluKGN1cmx5TGluZV83MjkgPT4ge1xuICAgICAgcmV0dXJuIHBvcF82NzEocF83MjcpLm1hcChpc0V4cHJQcmVmaXhfNjYzKGN1cmx5TGluZV83MjksIGJfNzIwKSk7XG4gICAgfSkuY2hhaW4oc3R1ZmZGYWxzZV82NTcocF83MjcpKTtcbiAgfSksIE1heWJlLmlzSnVzdCkocF83MjQpO1xufV0pO1xuZnVuY3Rpb24gbGFzdEVsXzY3NChsXzczMCkge1xuICByZXR1cm4gbF83MzBbbF83MzAubGVuZ3RoIC0gMV07XG59XG5leHBvcnQgZGVmYXVsdCBjbGFzcyBSZWFkZXIgZXh0ZW5kcyBUb2tlbml6ZXIge1xuICBjb25zdHJ1Y3RvcihzdHJpbmdzXzczMSwgY29udGV4dF83MzIsIHJlcGxhY2VtZW50c183MzMpIHtcbiAgICBzdXBlcihBcnJheS5pc0FycmF5KHN0cmluZ3NfNzMxKSA/IHN0cmluZ3NfNzMxLmpvaW4oXCJcIikgOiBzdHJpbmdzXzczMSk7XG4gICAgdGhpcy5kZWxpbVN0YWNrID0gbmV3IE1hcDtcbiAgICB0aGlzLmluc2lkZVN5bnRheFRlbXBsYXRlID0gW2ZhbHNlXTtcbiAgICB0aGlzLmNvbnRleHQgPSBjb250ZXh0XzczMjtcbiAgICBpZiAoQXJyYXkuaXNBcnJheShzdHJpbmdzXzczMSkpIHtcbiAgICAgIGxldCB0b3RhbEluZGV4ID0gMDtcbiAgICAgIHRoaXMucmVwbGFjZW1lbnRJbmRleCA9IFIucmVkdWNlKChhY2NfNzM0LCBzdHJSZXBfNzM1KSA9PiB7XG4gICAgICAgIGFjY183MzQucHVzaCh7aW5kZXg6IHRvdGFsSW5kZXggKyBzdHJSZXBfNzM1WzBdLmxlbmd0aCwgcmVwbGFjZW1lbnQ6IHN0clJlcF83MzVbMV19KTtcbiAgICAgICAgdG90YWxJbmRleCArPSBzdHJSZXBfNzM1WzBdLmxlbmd0aDtcbiAgICAgICAgcmV0dXJuIGFjY183MzQ7XG4gICAgICB9LCBbXSwgUi56aXAoc3RyaW5nc183MzEsIHJlcGxhY2VtZW50c183MzMpKTtcbiAgICB9XG4gIH1cbiAgcmVhZChzdGFja183MzYgPSBbXSwgYl83MzcgPSBmYWxzZSwgc2luZ2xlRGVsaW1pdGVyXzczOCA9IGZhbHNlKSB7XG4gICAgbGV0IHByZWZpeF83MzkgPSBMaXN0KCk7XG4gICAgd2hpbGUgKHRydWUpIHtcbiAgICAgIGxldCB0b2sgPSB0aGlzLmFkdmFuY2UocHJlZml4XzczOSwgYl83MzcpO1xuICAgICAgaWYgKHRvayBpbnN0YW5jZW9mIFN5bnRheCB8fCB0b2sgaW5zdGFuY2VvZiBUZXJtKSB7XG4gICAgICAgIHN0YWNrXzczNi5wdXNoKHRvayk7XG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgfVxuICAgICAgaWYgKEFycmF5LmlzQXJyYXkodG9rKSkge1xuICAgICAgICBBcnJheS5wcm90b3R5cGUucHVzaC5hcHBseShzdGFja183MzYsIHRvayk7XG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgfVxuICAgICAgaWYgKExpc3QuaXNMaXN0KHRvaykpIHtcbiAgICAgICAgQXJyYXkucHJvdG90eXBlLnB1c2guYXBwbHkoc3RhY2tfNzM2LCB0b2sudG9BcnJheSgpKTtcbiAgICAgICAgY29udGludWU7XG4gICAgICB9XG4gICAgICBpZiAoaXNFT1NfNjI4KHRvaykpIHtcbiAgICAgICAgaWYgKHN0YWNrXzczNlswXSAmJiBpc0xlZnREZWxpbWl0ZXJfNjMyKHN0YWNrXzczNlswXS50b2tlbikpIHtcbiAgICAgICAgICB0aHJvdyB0aGlzLmNyZWF0ZVVuZXhwZWN0ZWQodG9rKTtcbiAgICAgICAgfVxuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIGlmIChpc0xlZnREZWxpbWl0ZXJfNjMyKHRvaykpIHtcbiAgICAgICAgaWYgKGlzTGVmdFN5bnRheF82MzAodG9rKSkge1xuICAgICAgICAgIHRoaXMuaW5zaWRlU3ludGF4VGVtcGxhdGUucHVzaCh0cnVlKTtcbiAgICAgICAgfVxuICAgICAgICBsZXQgbGluZSA9IHRvay5zbGljZS5zdGFydExvY2F0aW9uLmxpbmU7XG4gICAgICAgIGxldCBpbm5lckIgPSBpc0xlZnRCcmFjZV82MjModG9rKSA/IGlzRXhwclByZWZpeF82NjMobGluZSwgYl83MzcpKHByZWZpeF83MzkpIDogdHJ1ZTtcbiAgICAgICAgbGV0IGlubmVyID0gdGhpcy5yZWFkKFtuZXcgU3ludGF4KHRvaywgdGhpcy5jb250ZXh0KV0sIGlubmVyQiwgZmFsc2UpO1xuICAgICAgICBsZXQgc3R4ID0gbmV3IFN5bnRheChpbm5lciwgdGhpcy5jb250ZXh0KTtcbiAgICAgICAgcHJlZml4XzczOSA9IHByZWZpeF83MzkuY29uY2F0KHN0eCk7XG4gICAgICAgIHN0YWNrXzczNi5wdXNoKHN0eCk7XG4gICAgICAgIGlmIChzaW5nbGVEZWxpbWl0ZXJfNzM4KSB7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSBpZiAoaXNSaWdodERlbGltaXRlcl82MzModG9rKSkge1xuICAgICAgICBpZiAoc3RhY2tfNzM2WzBdICYmICFpc01hdGNoaW5nRGVsaW1pdGVyc182MzQoc3RhY2tfNzM2WzBdLnRva2VuLCB0b2spKSB7XG4gICAgICAgICAgdGhyb3cgdGhpcy5jcmVhdGVVbmV4cGVjdGVkKHRvayk7XG4gICAgICAgIH1cbiAgICAgICAgbGV0IHN0eCA9IG5ldyBTeW50YXgodG9rLCB0aGlzLmNvbnRleHQpO1xuICAgICAgICBzdGFja183MzYucHVzaChzdHgpO1xuICAgICAgICBpZiAobGFzdEVsXzY3NCh0aGlzLmluc2lkZVN5bnRheFRlbXBsYXRlKSAmJiBpc1JpZ2h0U3ludGF4XzYzMSh0b2spKSB7XG4gICAgICAgICAgdGhpcy5pbnNpZGVTeW50YXhUZW1wbGF0ZS5wb3AoKTtcbiAgICAgICAgfVxuICAgICAgICBicmVhaztcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGxldCBzdHggPSBuZXcgU3ludGF4KHRvaywgdGhpcy5jb250ZXh0KTtcbiAgICAgICAgcHJlZml4XzczOSA9IHByZWZpeF83MzkuY29uY2F0KHN0eCk7XG4gICAgICAgIHN0YWNrXzczNi5wdXNoKHN0eCk7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBMaXN0KHN0YWNrXzczNik7XG4gIH1cbiAgYWR2YW5jZShwcmVmaXhfNzQwLCBiXzc0MSkge1xuICAgIGxldCBzdGFydExvY2F0aW9uXzc0MiA9IHRoaXMuZ2V0TG9jYXRpb24oKTtcbiAgICB0aGlzLmxhc3RJbmRleCA9IHRoaXMuaW5kZXg7XG4gICAgdGhpcy5sYXN0TGluZSA9IHRoaXMubGluZTtcbiAgICB0aGlzLmxhc3RMaW5lU3RhcnQgPSB0aGlzLmxpbmVTdGFydDtcbiAgICB0aGlzLnNraXBDb21tZW50KCk7XG4gICAgdGhpcy5zdGFydEluZGV4ID0gdGhpcy5pbmRleDtcbiAgICB0aGlzLnN0YXJ0TGluZSA9IHRoaXMubGluZTtcbiAgICB0aGlzLnN0YXJ0TGluZVN0YXJ0ID0gdGhpcy5saW5lU3RhcnQ7XG4gICAgaWYgKHRoaXMucmVwbGFjZW1lbnRJbmRleCAmJiB0aGlzLnJlcGxhY2VtZW50SW5kZXhbMF0gJiYgdGhpcy5pbmRleCA+PSB0aGlzLnJlcGxhY2VtZW50SW5kZXhbMF0uaW5kZXgpIHtcbiAgICAgIGxldCByZXAgPSB0aGlzLnJlcGxhY2VtZW50SW5kZXhbMF0ucmVwbGFjZW1lbnQ7XG4gICAgICB0aGlzLnJlcGxhY2VtZW50SW5kZXguc2hpZnQoKTtcbiAgICAgIHJldHVybiByZXA7XG4gICAgfVxuICAgIGxldCBjaGFyQ29kZV83NDMgPSB0aGlzLnNvdXJjZS5jaGFyQ29kZUF0KHRoaXMuaW5kZXgpO1xuICAgIGlmIChjaGFyQ29kZV83NDMgPT09IDk2KSB7XG4gICAgICBsZXQgZWxlbWVudCwgaXRlbXMgPSBbXTtcbiAgICAgIGxldCBzdGFydExvY2F0aW9uXzc0MiA9IHRoaXMuZ2V0TG9jYXRpb24oKTtcbiAgICAgIGxldCBzdGFydCA9IHRoaXMuaW5kZXg7XG4gICAgICB0aGlzLmluZGV4Kys7XG4gICAgICBpZiAobGFzdEVsXzY3NCh0aGlzLmluc2lkZVN5bnRheFRlbXBsYXRlKSkge1xuICAgICAgICBsZXQgc2xpY2UgPSB0aGlzLmdldFNsaWNlKHN0YXJ0LCBzdGFydExvY2F0aW9uXzc0Mik7XG4gICAgICAgIHJldHVybiB7dHlwZTogUlNZTlRBWF82MTksIHZhbHVlOiBcImBcIiwgc2xpY2U6IHNsaWNlfTtcbiAgICAgIH1cbiAgICAgIGRvIHtcbiAgICAgICAgZWxlbWVudCA9IHRoaXMuc2NhblRlbXBsYXRlRWxlbWVudCgpO1xuICAgICAgICBpdGVtcy5wdXNoKGVsZW1lbnQpO1xuICAgICAgICBpZiAoZWxlbWVudC5pbnRlcnApIHtcbiAgICAgICAgICBlbGVtZW50ID0gdGhpcy5yZWFkKFtdLCBmYWxzZSwgdHJ1ZSk7XG4gICAgICAgICAgYXNzZXJ0KGVsZW1lbnQuc2l6ZSA9PT0gMSwgXCJzaG91bGQgb25seSBoYXZlIHJlYWQgYSBzaW5nbGUgZGVsaW1pdGVyIGluc2lkZSBhIHRlbXBsYXRlXCIpO1xuICAgICAgICAgIGl0ZW1zLnB1c2goZWxlbWVudC5nZXQoMCkpO1xuICAgICAgICB9XG4gICAgICB9IHdoaWxlICghZWxlbWVudC50YWlsKTtcbiAgICAgIHJldHVybiB7dHlwZTogVG9rZW5UeXBlLlRFTVBMQVRFLCBpdGVtczogTGlzdChpdGVtcyl9O1xuICAgIH0gZWxzZSBpZiAoY2hhckNvZGVfNzQzID09PSAzNSkge1xuICAgICAgbGV0IHN0YXJ0TG9jYXRpb25fNzQyID0gdGhpcy5nZXRMb2NhdGlvbigpO1xuICAgICAgbGV0IHN0YXJ0ID0gdGhpcy5pbmRleDtcbiAgICAgIGxldCBzbGljZSA9IHRoaXMuZ2V0U2xpY2Uoc3RhcnQsIHN0YXJ0TG9jYXRpb25fNzQyKTtcbiAgICAgIHRoaXMuaW5kZXgrKztcbiAgICAgIGlmICh0aGlzLnNvdXJjZS5jaGFyQ29kZUF0KHRoaXMuaW5kZXgpID09PSA5Nikge1xuICAgICAgICB0aGlzLmluZGV4Kys7XG4gICAgICAgIHJldHVybiB7dHlwZTogTFNZTlRBWF82MTgsIHZhbHVlOiBcIiNgXCIsIHNsaWNlOiBzbGljZX07XG4gICAgICB9XG4gICAgICByZXR1cm4ge3R5cGU6IFRva2VuVHlwZS5JREVOVElGSUVSLCB2YWx1ZTogXCIjXCIsIHNsaWNlOiBzbGljZX07XG4gICAgfSBlbHNlIGlmIChjaGFyQ29kZV83NDMgPT09IDY0KSB7XG4gICAgICBsZXQgc3RhcnRMb2NhdGlvbl83NDIgPSB0aGlzLmdldExvY2F0aW9uKCk7XG4gICAgICBsZXQgc3RhcnQgPSB0aGlzLmluZGV4O1xuICAgICAgbGV0IHNsaWNlID0gdGhpcy5nZXRTbGljZShzdGFydCwgc3RhcnRMb2NhdGlvbl83NDIpO1xuICAgICAgdGhpcy5pbmRleCsrO1xuICAgICAgcmV0dXJuIHt0eXBlOiBBVF82MjAsIHZhbHVlOiBcIkBcIiwgc2xpY2U6IHNsaWNlfTtcbiAgICB9XG4gICAgbGV0IGxvb2thaGVhZF83NDQgPSBzdXBlci5hZHZhbmNlKCk7XG4gICAgaWYgKGxvb2thaGVhZF83NDQudHlwZSA9PT0gVG9rZW5UeXBlLkRJViAmJiBpc1JlZ2V4UHJlZml4XzY3MyhiXzc0MSkocHJlZml4Xzc0MCkpIHtcbiAgICAgIHJldHVybiBzdXBlci5zY2FuUmVnRXhwKFwiL1wiKTtcbiAgICB9XG4gICAgcmV0dXJuIGxvb2thaGVhZF83NDQ7XG4gIH1cbiAgc2NhblRlbXBsYXRlRWxlbWVudCgpIHtcbiAgICBsZXQgc3RhcnRMb2NhdGlvbl83NDUgPSB0aGlzLmdldExvY2F0aW9uKCk7XG4gICAgbGV0IHN0YXJ0Xzc0NiA9IHRoaXMuaW5kZXg7XG4gICAgd2hpbGUgKHRoaXMuaW5kZXggPCB0aGlzLnNvdXJjZS5sZW5ndGgpIHtcbiAgICAgIGxldCBjaCA9IHRoaXMuc291cmNlLmNoYXJDb2RlQXQodGhpcy5pbmRleCk7XG4gICAgICBzd2l0Y2ggKGNoKSB7XG4gICAgICAgIGNhc2UgOTY6XG4gICAgICAgICAgbGV0IHNsaWNlID0gdGhpcy5nZXRTbGljZShzdGFydF83NDYsIHN0YXJ0TG9jYXRpb25fNzQ1KTtcbiAgICAgICAgICB0aGlzLmluZGV4Kys7XG4gICAgICAgICAgcmV0dXJuIHt0eXBlOiBUb2tlblR5cGUuVEVNUExBVEUsIHRhaWw6IHRydWUsIGludGVycDogZmFsc2UsIHNsaWNlOiBzbGljZX07XG4gICAgICAgIGNhc2UgMzY6XG4gICAgICAgICAgaWYgKHRoaXMuc291cmNlLmNoYXJDb2RlQXQodGhpcy5pbmRleCArIDEpID09PSAxMjMpIHtcbiAgICAgICAgICAgIGxldCBzbGljZSA9IHRoaXMuZ2V0U2xpY2Uoc3RhcnRfNzQ2LCBzdGFydExvY2F0aW9uXzc0NSk7XG4gICAgICAgICAgICB0aGlzLmluZGV4ICs9IDE7XG4gICAgICAgICAgICByZXR1cm4ge3R5cGU6IFRva2VuVHlwZS5URU1QTEFURSwgdGFpbDogZmFsc2UsIGludGVycDogdHJ1ZSwgc2xpY2U6IHNsaWNlfTtcbiAgICAgICAgICB9XG4gICAgICAgICAgdGhpcy5pbmRleCsrO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIDkyOlxuICAgICAgICAgIHtcbiAgICAgICAgICAgIGxldCBvY3RhbCA9IHRoaXMuc2NhblN0cmluZ0VzY2FwZShcIlwiLCBudWxsKVsxXTtcbiAgICAgICAgICAgIGlmIChvY3RhbCAhPSBudWxsKSB7XG4gICAgICAgICAgICAgIHRocm93IHRoaXMuY3JlYXRlSUxMRUdBTCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgIHRoaXMuaW5kZXgrKztcbiAgICAgIH1cbiAgICB9XG4gICAgdGhyb3cgdGhpcy5jcmVhdGVJTExFR0FMKCk7XG4gIH1cbn1cbiJdfQ==